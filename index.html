<!DOCTYPE html>
<html class="h-full" data-kt-theme="true" data-kt-theme-mode="light" dir="ltr" lang="en">
  <head>
    <!-- <base href="../../"> -->
    <title>CaseLoom Meeting</title>
    <meta charset="utf-8" />
    <meta content="follow, index" name="robots" />
    <link href="" rel="canonical" />
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport" />
    <meta content="" name="description" />
    <meta content="@keenthemes" name="twitter:site" />
    <meta content="@keenthemes" name="twitter:creator" />
    <meta content="summary_large_image" name="twitter:card" />
    <meta content="" name="twitter:title" />
    <meta content="" name="twitter:description" />
    <meta content="" name="twitter:image" />
    <meta content="" property="og:url" />
    <meta content="en_US" property="og:locale" />
    <meta content="website" property="og:type" />
    <meta content="@keenthemes" property="og:site_name" />
    <meta content="" property="og:title" />
    <meta content="" property="og:description" />
    <meta content="" property="og:image" />
    <link href="assets/media/app/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180" />
    <link href="assets/media/app/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png" />
    <link href="assets/media/app/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png" />
    <link href="assets/media/app/favicon.ico" rel="shortcut icon" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Work+Sans:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet" />
    <link href="assets/vendors/apexcharts/apexcharts.css" rel="stylesheet" />
    <link href="assets/vendors/keenicons/styles.bundle.css" rel="stylesheet" />
    <link href="assets/css/styles.css" rel="stylesheet" />
    <link href="assets/css/style-toast.css" rel="stylesheet" />
    <link href="assets/css/style-custom.css" rel="stylesheet" />
  </head>

  <body class="flex h-full text-base text-foreground bg-background kt-header-fixed overflow-hidden">
    <div class="kt-wrapper flex grow flex-col">
      <!-- Meeting Header -->
      <header class="kt-header fixed top-0 left-0 right-0 z-4 bg-gray-800 px-3.5 h-[60px] flex items-center bg-background">
        <div class="h-full w-full rounded-lg flex items-center justify-between shadow-sm relative">
          <div class="flex items-center gap-10">
            <h2 class="text-mono font-semibold leading-5 tracking-normal">Trial of Stacey Lewis</h2>
            <div class="text-destructive flex items-center gap-2">
              <svg class="text-destructive" width="12" height="12" viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg">
                <!-- <svg class="text-accent-foreground/60" width="12" height="12" viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"> -->
                <circle cx="6" cy="6" r="5" fill="none" stroke="currentColor" stroke-width="1" />
                <circle cx="6" cy="6" r="3" fill="currentColor" />
              </svg>
              <span class="text-sm font-medium">02:35</span>
            </div>
          </div>
          <div class="flex items-center gap-2.5">
            <div class="flex items-center gap-0">
              <a href="javascript:;" id="caption-btn" class="kt-menu-link flex flex-col items-center justify-center gap-1 px-1 py-1 mx-1 min-w-12">
                <svg class="kt-menu-link-hover:text-primary" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path
                    d="M1.74414 1H13.9521C14.247 1.00033 14.6953 1.31767 14.6953 1.97852V13.7168C14.6953 14.3776 14.247 14.695 13.9521 14.6953H1.74414C1.44932 14.6953 1 14.378 1 13.7168V1.97852C1 1.31732 1.44932 1 1.74414 1ZM3.26953 7.27637C2.30459 7.27658 1.6954 8.06839 1.62305 8.86035L1.61621 9.01855L1.62305 9.17676C1.67009 9.69144 1.94476 10.2047 2.39551 10.502C1.94449 10.7992 1.67004 11.3132 1.62305 11.8281L1.61621 11.9863L1.62305 12.1445C1.6955 12.9364 2.30468 13.7283 3.26953 13.7285H5.4502C5.89499 13.7284 6.26321 13.5587 6.53906 13.2998C6.81507 13.5592 7.18449 13.7285 7.62988 13.7285H12.4258C13.4552 13.7285 14.08 12.8274 14.0801 11.9863C14.0801 11.4208 13.7966 10.8295 13.2988 10.502C13.7964 10.1744 14.0801 9.58391 14.0801 9.01855C14.0801 8.1774 13.4552 7.2764 12.4258 7.27637H10.2461C9.80098 7.27637 9.43123 7.44496 9.15527 7.7041C8.87938 7.44525 8.51025 7.27637 8.06543 7.27637H3.26953Z"
                    fill="currentColor"
                    stroke="currentColor"
                    stroke-width="2"
                  />
                </svg>
                <span class="text-2xs kt-menu-link-hover:text-primary">Caption</span>
              </a>
              <a href="#" class="kt-menu-link flex flex-col items-center justify-center gap-1 px-1 py-1 mx-1 min-w-12">
                <svg class="kt-menu-link-hover:text-primary" width="18" height="15" viewBox="0 0 18 15" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path
                    d="M16 1.60715L2 1.60714C1.725 1.60714 1.5 1.84821 1.5 2.14286L1.5 5.39397C1.25313 5.37054 1.00313 5.35714 0.750002 5.35714L1.68601e-06 5.35714L2.24801e-06 2.14286C2.45467e-06 0.960938 0.896878 1.56815e-07 2 3.49691e-07L16 2.79753e-06C17.1031 2.99041e-06 18 0.960941 18 2.14286L18 12.8571C18 14.0391 17.1031 15 16 15L9 15L9 14.1964C9 13.9252 8.9875 13.6574 8.96563 13.3929L16 13.3929C16.275 13.3929 16.5 13.1518 16.5 12.8571L16.5 2.14286C16.5 1.84822 16.275 1.60715 16 1.60715ZM0.750001 6.42857C4.75313 6.42857 8 9.90737 8 14.1964C8 14.6417 7.66563 15 7.25 15C6.83437 15 6.5 14.6417 6.5 14.1964C6.5 10.7946 3.925 8.03572 0.750001 8.03572C0.334376 8.03572 1.28031e-06 7.67746 1.35817e-06 7.23214C1.43604e-06 6.78683 0.334376 6.42857 0.750001 6.42857ZM1 12.8571C1.26522 12.8571 1.51957 12.97 1.70711 13.171C1.89464 13.3719 2 13.6444 2 13.9286C2 14.2127 1.89464 14.4853 1.70711 14.6862C1.51957 14.8871 1.26522 15 1 15C0.734784 15 0.48043 14.8871 0.292893 14.6862C0.105357 14.4853 1.37649e-07 14.2127 1.87333e-07 13.9286C2.37018e-07 13.6444 0.105357 13.3719 0.292894 13.171C0.48043 12.97 0.734784 12.8571 1 12.8571ZM7.96171e-07 10.4464C8.74032e-07 10.0011 0.334376 9.64286 0.750001 9.64286C3.09688 9.64286 5 11.6819 5 14.1964C5 14.6417 4.66563 15 4.25 15C3.83437 15 3.5 14.6417 3.5 14.1964C3.5 12.5692 2.26875 11.25 0.750001 11.25C0.334376 11.25 7.1831e-07 10.8917 7.96171e-07 10.4464Z"
                    fill="currentColor"
                  />
                </svg>
                <span class="text-2xs kt-menu-link-hover:text-primary">Witness</span>
              </a>
              <div class="kt-menu" data-kt-menu="true">
                <div class="kt-menu-item" data-kt-menu-item-offset="-50%, 0" data-kt-menu-item-placement="bottom-start" data-kt-menu-item-toggle="dropdown" data-kt-menu-item-trigger="click">
                  <button class="kt-menu-link flex flex-col items-center justify-center gap-1 px-1 py-1 mx-1 min-w-12">
                    <svg class="kt-menu-link-hover:text-primary" width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path
                        d="M2.66337 2.75009L2.69307 9.87469L14.3366 9.87469L14.3069 2.75009L2.66337 2.75009ZM14.3069 1C15.2244 1 15.9703 1.78481 15.9703 2.75009L16 9.87469C16 10.84 15.2541 11.6248 14.3366 11.6248L2.69307 11.6248C1.77562 11.6248 1.0297 10.84 1.0297 9.87469L1 2.75009C1 1.78481 1.74592 1 2.66337 1L14.3069 1ZM16 14.2499L16 15.125C16 15.609 15.6283 16 15.1683 16L14.3366 16C13.8766 16 13.505 15.609 13.505 15.125L13.505 14.2499C13.505 13.7659 13.8766 13.3749 14.3366 13.3749L15.1683 13.3749C15.6283 13.3749 16 13.7659 16 14.2499ZM11.0099 13.3749C11.4699 13.3749 11.8416 13.7659 11.8416 14.2499L11.8416 15.125C11.8416 15.609 11.4699 16 11.0099 16L10.1782 16C9.71819 16 9.34654 15.609 9.34654 15.125L9.34654 14.2499C9.34654 13.7659 9.71819 13.3749 10.1782 13.3749L11.0099 13.3749ZM7.68316 14.2499L7.68316 15.125C7.68316 15.609 7.31151 16 6.85148 16L6.0198 16C5.55977 16 5.18812 15.609 5.18812 15.125L5.18812 14.2499C5.18812 13.7659 5.55977 13.3749 6.0198 13.3749L6.85148 13.3749C7.31151 13.3749 7.68316 13.7659 7.68316 14.2499ZM2.69307 13.3749C3.15309 13.3749 3.52475 13.7659 3.52475 14.2499L3.52475 15.125C3.52475 15.609 3.15309 16 2.69307 16L1.86138 16C1.40136 16 1.0297 15.609 1.0297 15.125L1.0297 14.2499C1.0297 13.7659 1.40136 13.3749 1.86138 13.3749L2.69307 13.3749Z"
                        fill="currentColor"
                      ></path>
                    </svg>
                    <span class="text-2xs kt-menu-link-hover:text-primary">View</span>
                  </button>
                  <div class="kt-menu-dropdown kt-menu-default w-full max-w-[220px] border-0 shadow-drop rounded-lg py-3" data-kt-menu-dismiss="true">
                    <div class="kt-menu-item">
                      <a class="kt-menu-link flex gap-2" href="#">
                        <svg class="kt-menu-link-hover:text-primary" width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">
                          <path
                            d="M2.66337 2.75009L2.69307 9.87469L14.3366 9.87469L14.3069 2.75009L2.66337 2.75009ZM14.3069 1C15.2244 1 15.9703 1.78481 15.9703 2.75009L16 9.87469C16 10.84 15.2541 11.6248 14.3366 11.6248L2.69307 11.6248C1.77562 11.6248 1.0297 10.84 1.0297 9.87469L1 2.75009C1 1.78481 1.74592 1 2.66337 1L14.3069 1ZM16 14.2499L16 15.125C16 15.609 15.6283 16 15.1683 16L14.3366 16C13.8766 16 13.505 15.609 13.505 15.125L13.505 14.2499C13.505 13.7659 13.8766 13.3749 14.3366 13.3749L15.1683 13.3749C15.6283 13.3749 16 13.7659 16 14.2499ZM11.0099 13.3749C11.4699 13.3749 11.8416 13.7659 11.8416 14.2499L11.8416 15.125C11.8416 15.609 11.4699 16 11.0099 16L10.1782 16C9.71819 16 9.34654 15.609 9.34654 15.125L9.34654 14.2499C9.34654 13.7659 9.71819 13.3749 10.1782 13.3749L11.0099 13.3749ZM7.68316 14.2499L7.68316 15.125C7.68316 15.609 7.31151 16 6.85148 16L6.0198 16C5.55977 16 5.18812 15.609 5.18812 15.125L5.18812 14.2499C5.18812 13.7659 5.55977 13.3749 6.0198 13.3749L6.85148 13.3749C7.31151 13.3749 7.68316 13.7659 7.68316 14.2499ZM2.69307 13.3749C3.15309 13.3749 3.52475 13.7659 3.52475 14.2499L3.52475 15.125C3.52475 15.609 3.15309 16 2.69307 16L1.86138 16C1.40136 16 1.0297 15.609 1.0297 15.125L1.0297 14.2499C1.0297 13.7659 1.40136 13.3749 1.86138 13.3749L2.69307 13.3749Z"
                            fill="currentColor"
                          />
                        </svg>
                        <span class="kt-menu-link-hover:text-primary kt-menu-title text-sm"> Documents & Speakers </span>
                      </a>
                    </div>
                    <div class="kt-menu-item">
                      <a class="kt-menu-link flex gap-2" href="#">
                        <svg class="kt-menu-link-hover:text-primary" width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">
                          <path
                            d="M6.9827 7.81475L12.5119 3.79267L13.2654 4.53665L9.19436 9.99845L6.9827 7.81475ZM4.38528 10.1254L3.73207 10.7704C3.41061 11.0878 3.41061 11.6032 3.73207 11.9206L5.03592 13.208C5.35738 13.5254 5.87944 13.5254 6.2009 13.208L6.85411 12.563H8.69802C9.09149 12.563 9.45924 12.3802 9.6907 12.0679L14.8675 5.13336C15.009 4.94546 15.0836 4.71693 15.0836 4.48333C15.0836 4.19386 14.9678 3.91455 14.7595 3.70888L13.3502 2.31994C13.1419 2.11427 12.8616 2 12.5684 2C12.3318 2 12.1004 2.07364 11.9101 2.21329L4.88676 7.32214C4.57044 7.55067 4.38528 7.91631 4.38528 8.30227V10.1229V10.1254ZM2.89627 12.2406L1.2761 13.8402C1.16037 13.9545 1.09608 14.1094 1.09608 14.2719L1.09351 14.3912C1.09351 14.729 1.36868 15.0007 1.71071 15.0007H3.47747C3.64206 15.0007 3.79893 14.9372 3.91466 14.8229L4.71189 14.0358L2.89627 12.2406ZM6.85411 13.7818C6.51208 13.7818 6.23691 14.0535 6.23691 14.3912C6.23691 14.729 6.51208 15.0007 6.85411 15.0007H15.2893C15.6313 15.0007 15.9065 14.729 15.9065 14.3912C15.9065 14.0535 15.6313 13.7818 15.2893 13.7818H6.85411Z"
                            fill="currentColor"
                          />
                        </svg>
                        <span class="kt-menu-link-hover:text-primary kt-menu-title text-sm"> Documents Only </span>
                      </a>
                    </div>
                    <div class="kt-menu-item">
                      <a class="kt-menu-link flex gap-2" href="#">
                        <svg class="kt-menu-link-hover:text-primary" width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">
                          <path
                            d="M8.5 1C7.50544 1 6.55161 1.39509 5.84835 2.09835C5.14509 2.80161 4.75 3.75544 4.75 4.75C4.75 5.74456 5.14509 6.69839 5.84835 7.40165C6.55161 8.10491 7.50544 8.5 8.5 8.5C9.49456 8.5 10.4484 8.10491 11.1517 7.40165C11.8549 6.69839 12.25 5.74456 12.25 4.75C12.25 3.75544 11.8549 2.80161 11.1517 2.09835C10.4484 1.39509 9.49456 1 8.5 1ZM6.21191 10.2256C6.10938 10.0732 5.92481 9.99121 5.74609 10.0322C3.56348 10.5361 1.9375 12.4932 1.9375 14.8281V15.0625C1.9375 15.5811 2.35645 16 2.875 16H14.125C14.6436 16 15.0625 15.5811 15.0625 15.0625V14.8281C15.0625 12.4932 13.4365 10.5361 11.2539 10.0322C11.0752 9.99121 10.8906 10.0732 10.7881 10.2256L8.88965 13.0703C8.70508 13.3486 8.29492 13.3486 8.11035 13.0703L6.21191 10.2256Z"
                            fill="currentColor"
                          />
                        </svg>
                        <span class="kt-menu-link-hover:text-primary kt-menu-title text-sm"> Speakers Only </span>
                      </a>
                    </div>
                  </div>
                </div>
              </div>
              <div class="kt-menu" data-kt-menu="true">
                <div class="kt-menu-item" data-kt-menu-item-offset="-50%, 0" data-kt-menu-item-placement="bottom-start" data-kt-menu-item-toggle="dropdown" data-kt-menu-item-trigger="click">
                  <button class="kt-menu-link flex flex-col items-center justify-center gap-1 px-1 py-1 mx-1 min-w-12">
                    <i class="kt-menu-link-hover:text-primary ki-solid ki-dots-horizontal text-lg"></i>
                    <span class="text-2xs kt-menu-link-hover:text-primary">More</span>
                  </button>
                  <div class="kt-menu-dropdown kt-menu-default w-full max-w-[220px] border-0 shadow-drop rounded-lg py-3" data-kt-menu-dismiss="true">
                    <div class="kt-menu-item">
                      <a class="kt-menu-link flex gap-2" href="javascript:;" data-kt-modal-toggle="#device_setting_modal">
                        <i class="kt-menu-link-hover:text-primary ki-solid ki-setting text-base text-muted-foreground"></i>
                        <span class="kt-menu-link-hover:text-primary kt-menu-title text-sm"> Device settings </span>
                      </a>
                    </div>
                    <div class="kt-menu-item">
                      <a class="kt-menu-link flex gap-2" href="#">
                        <svg class="kt-menu-link-hover:text-primary" width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">
                          <path
                            d="M8.5 1C4.91015 1 2 3.91015 2 7.5C2 11.0899 4.91015 14 8.5 14C12.0899 14 15 11.0899 15 7.5C15 3.91015 12.0899 1 8.5 1ZM8.5 2C11.5376 2 14 4.46243 14 7.5C14 10.5376 11.5376 13 8.5 13C5.46243 13 3 10.5376 3 7.5C3 4.46243 5.46243 2 8.5 2ZM8.5 4C8.22386 4 8 4.22386 8 4.5V7.5C8 7.77614 8.22386 8 8.5 8C8.77614 8 9 7.77614 9 7.5V4.5C9 4.22386 8.77614 4 8.5 4ZM8.5 9C8.22386 9 8 9.22386 8 9.5V10.5C8 10.7761 8.22386 11 8.5 11C8.77614 11 9 10.7761 9 10.5V9.5C9 9.22386 8.77614 9 8.5 9Z"
                            fill="currentColor"
                          />
                        </svg>
                        <span class="kt-menu-link-hover:text-primary kt-menu-title text-sm"> Meeting info </span>
                      </a>
                    </div>
                    <div class="kt-menu-item">
                      <a class="kt-menu-link flex gap-2" href="#">
                        <svg class="kt-menu-link-hover:text-primary" width="18px" height="18px" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
                          <circle cx="9" cy="9" r="8" fill="none" stroke="currentColor" stroke-width="2" />
                          <circle cx="9" cy="9" r="4" fill="currentColor" />
                        </svg>
                        <span class="kt-menu-link-hover:text-primary kt-menu-title text-sm"> Start Recording </span>
                      </a>
                    </div>
                    <div class="kt-menu-item">
                      <a class="kt-menu-link flex gap-2" href="#">
                        <svg class="kt-menu-link-hover:text-primary" width="18px" height="18px" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
                          <circle cx="9" cy="9" r="8" fill="none" stroke="currentColor" stroke-width="2" />
                          <rect x="6" y="5" width="1.5" height="8" fill="currentColor" />
                          <rect x="10.5" y="5" width="1.5" height="8" fill="currentColor" />
                        </svg>
                        <span class="kt-menu-link-hover:text-primary kt-menu-title text-sm"> Pause Recording </span>
                      </a>
                    </div>
                    <div class="kt-menu-item">
                      <a class="kt-menu-link kt-menu-link-hover:text-destructive text-destructive flex gap-2" href="#">
                        <svg class="kt-menu-link-hover:text-destructive" width="18px" height="18px" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
                          <circle cx="9" cy="9" r="8" fill="none" stroke="currentColor" stroke-width="2" />
                          <rect x="6.5" y="6.5" width="5" height="5" fill="currentColor" />
                        </svg>
                        <span class="text-destructive kt-menu-link-hover:text-destructive kt-menu-title text-sm"> Stop Recording </span>
                      </a>
                    </div>
                    <div class="kt-menu-item">
                      <div class="kt-menu-link flex gap-2">
                        <i class="kt-menu-link-hover:text-primary ki-solid ki-moon text-base text-muted-foreground"></i>
                        <span class="kt-menu-link-hover:text-primary kt-menu-title text-sm flex justify-between">
                          Dark Mode
                          <input class="kt-switch mx-2" data-kt-theme-switch-state="dark" data-kt-theme-switch-toggle="true" name="check" type="checkbox" value="1" />
                        </span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="kt-separator-vertical bg-border min-h-[42px] mx-3.5"></div>
              <a href="#" class="kt-menu-link flex flex-col items-center justify-center gap-1 px-1 py-1 mx-1 min-w-12">
                <svg class="kt-menu-link-hover:text-primary" width="20" height="19" viewBox="0 0 20 19" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path
                    d="M2.81494 4.45801H10.9077C11.791 4.45824 12.4302 5.10491 12.4302 5.80566V13.1943C12.43 13.895 11.7909 14.5408 10.9077 14.541H2.81494C1.9315 14.541 1.29164 13.8951 1.2915 13.1943V5.80566L1.29932 5.6748C1.37274 5.02622 1.98656 4.45801 2.81494 4.45801ZM17.6851 5.46387C17.8491 5.36498 18.0664 5.35365 18.2446 5.43945V5.44043C18.4199 5.52661 18.4995 5.6745 18.4995 5.80566V13.1943C18.4994 13.3254 18.4198 13.4734 18.2446 13.5596C18.0689 13.6458 17.8523 13.6361 17.686 13.5352L14.6509 11.6875H14.6519L14.4419 11.5596V7.43945L14.6509 7.31055L17.6851 5.46387Z"
                    fill="currentColor"
                    stroke="currentColor"
                  />
                </svg>
                <span class="text-2xs kt-menu-link-hover:text-primary">Camera</span>
              </a>
              <a href="#" class="kt-menu-link flex flex-col items-center justify-center gap-1 px-1 py-1 mx-1 min-w-12">
                <svg class="kt-menu-link-hover:text-primary" width="19" height="19" viewBox="0 0 19 19" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path
                    d="M9.5 0.791016C11.288 0.791016 12.7386 2.25374 12.7386 4.05664V9.49935C12.7386 11.3022 11.288 12.765 9.5 12.765C7.712 12.765 6.26136 11.3022 6.26136 9.49935V4.05664C6.26136 2.25374 7.712 0.791016 9.5 0.791016ZM13.8182 8.13867C13.8182 7.68625 14.1792 7.32227 14.6278 7.32227C15.0765 7.32227 15.4375 7.68625 15.4375 8.13867V9.49935C15.4375 12.5303 13.2042 15.0339 10.3097 15.4319V16.5749H11.929C12.3777 16.5749 12.7386 16.9389 12.7386 17.3913C12.7386 17.8437 12.3777 18.2077 11.929 18.2077H9.5H7.07102C6.62234 18.2077 6.26136 17.8437 6.26136 17.3913C6.26136 16.9389 6.62234 16.5749 7.07102 16.5749H8.69034V15.4319C5.79581 15.0339 3.5625 12.5303 3.5625 9.49935V8.13867C3.5625 7.68625 3.92347 7.32227 4.37216 7.32227C4.82084 7.32227 5.18182 7.68625 5.18182 8.13867V9.49935C5.18182 11.9043 7.11488 13.8535 9.5 13.8535C11.8851 13.8535 13.8182 11.9043 13.8182 9.49935V8.13867Z"
                    fill="currentColor"
                  />
                </svg>
                <span class="text-2xs kt-menu-link-hover:text-primary">Mic</span>
              </a>
              <a href="#" class="kt-menu-link flex flex-col items-center justify-center gap-1 px-1 py-1 mx-1 min-w-12">
                <svg class="kt-menu-link-hover:text-primary" width="19" height="19" viewBox="0 0 19 19" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path
                    d="M15.4007 1.65234C16.7026 1.65234 17.761 2.65785 17.761 3.89458V15.1058C17.761 16.3425 16.7026 17.348 15.4007 17.348H3.59951C2.29768 17.348 1.23926 16.3425 1.23926 15.1058V3.89458C1.23926 2.65785 2.29768 1.65234 3.59951 1.65234H15.4007ZM7.13988 5.57626C6.64939 5.57626 6.25479 5.95113 6.25479 6.4171C6.25479 6.88306 6.64939 7.25793 7.13988 7.25793H10.6102L5.62784 11.9877C5.28118 12.317 5.28118 12.8495 5.62784 13.1753C5.97451 13.5012 6.53506 13.5047 6.87804 13.1753L11.8567 8.44562L11.8604 12.0227C11.8604 12.4887 12.255 12.8635 12.7455 12.8635C13.236 12.8635 13.6306 12.4887 13.6306 12.0227V6.4171C13.6306 5.95113 13.236 5.57626 12.7455 5.57626H7.13988Z"
                    fill="currentColor"
                  />
                </svg>
                <span class="text-2xs kt-menu-link-hover:text-primary">Share Screen</span>
              </a>
            </div>
            <button class="kt-btn kt-btn-destructive px-4 text-sm h-[36px]">
              <svg width="18" height="9" viewBox="0 0 18 9" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M9.00071 1.4406C5.42388 1.4406 2.76311 3.29838 1.48346 4.62794C1.3538 4.763 1.29743 5.0151 1.42427 5.28221L2.44179 7.42811C2.48688 7.52415 2.58836 7.57517 2.68701 7.55417L5.57327 6.94491C5.67756 6.9239 5.75366 6.82486 5.75366 6.71081V4.57692C5.75366 4.26479 5.93969 3.99167 6.21873 3.89263L6.31457 3.85962C8.05929 3.24736 9.94213 3.24736 11.6897 3.85962L11.7855 3.89263C12.0617 3.98867 12.2506 4.26479 12.2506 4.57692V6.71081C12.2506 6.82486 12.3267 6.9239 12.431 6.94491L15.3144 7.55417C15.4131 7.57517 15.5145 7.52415 15.5596 7.42811L16.5772 5.28221C16.704 5.0151 16.6504 4.763 16.518 4.62794C15.2383 3.29838 12.5775 1.4406 9.00071 1.4406ZM0.53922 3.59551C1.99645 2.08287 4.98136 0 9.00071 0C13.0201 0 16.005 2.08287 17.4622 3.59551C18.0823 4.24078 18.133 5.19818 17.7835 5.93049L16.766 8.07638C16.4475 8.74867 15.7457 9.11482 15.0495 8.96776L12.166 8.3585C11.4275 8.20244 10.8948 7.51215 10.8948 6.71081V5.10814C9.65463 4.74799 8.34679 4.74799 7.1066 5.10814V6.71081C7.1066 7.51215 6.57388 8.20244 5.8354 8.3585L2.94914 8.96776C2.25294 9.11482 1.5511 8.74867 1.2326 8.07638L0.215079 5.93049C-0.131611 5.19818 -0.0836943 4.24078 0.53922 3.59551Z"
                  fill="currentColor"
                />
              </svg>
              <span class="hidden lg:inline">Leave</span>
            </button>
          </div>
        </div>
      </header>
      <div class="w-full h-[60px] px-3.5 py-5">&nbsp;</div>
      <!-- End Meeting Header -->
      <main class="grow px-1.5 py-1.5 overflow-hidden bg-muted!" id="content" role="content">
        <div id="kt_splitter_main" class="kt_splitter_main splitter splitter-horizontal flex h-full gap-0">
          <aside id="kt_splitter_main_left" class="kt_aside_left shadow-sm transition-all duration-400 flex w-[300px] min-w-[300px] h-full top-0 left-0 fixed shadow-none relative" data-splitter-pane="left">
            <div id="kt_splitter_left_verticle" class="splitter w-full h-full flex flex-col">
              <div id="first_documents_accordion" class="splitter-pane h-half bg-background rounded-lg px-4 py-4 pt-0 kt-scrollable-y-auto min-w-[300px]" data-splitter-pane="top">
                <div class="sticky top-0 bg-background pt-4 pb-4 z-1">
                  <div class="flex items-center justify-between gap-2">
                    <div class="text-base font-semibold leading-5 tracking-normal mt-1 text-nowrap">Lead Counsel Documents</div>
                    <button id="kt_aside_toggle_left_mobile" class="kt-btn kt-btn-outline kt-btn-icon size-[30px] h-[36px] xl:hidden" data-kt-toggle="true" data-kt-toggle-state="active" data-kt-toggle-target="body" data-kt-toggle-name="aside-minimize">
                      <i class="ki-duotone ki-double-left fs-3 transition-transform duration-300">
                        <span class="path1"></span>
                        <span class="path2"></span>
                      </i>
                    </button>
                  </div>
                  <div class="flex justify-between gap-1 mt-3">
                    <button class="kt-btn kt-btn-outline kt-btn-primary kt-btn-sm rounded-sm line-height-1 dark:bg-white dark:text-dark" data-kt-modal-toggle="#upload_document_modal">
                      <svg class="w-auto h-auto dark:text-dark" width="9" height="10" viewBox="0 0 9 10" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path
                          d="M7.85714 6.86893e-07C8.25223 7.21433e-07 8.57143 0.319196 8.57143 0.714287C8.57143 1.10938 8.25223 1.42857 7.85714 1.42857L0.714287 1.42857C0.319197 1.42857 7.77243e-07 1.10938 8.11783e-07 0.714286C8.46323e-07 0.319196 0.319198 2.79051e-08 0.714287 6.24449e-08L7.85714 6.86893e-07ZM3.78125 3.06696C4.06027 2.78795 4.51339 2.78795 4.79241 3.06696L7.64955 5.92411C7.92857 6.20313 7.92857 6.65625 7.64955 6.93527C7.37054 7.21429 6.91741 7.21429 6.63839 6.93527L5 5.29688L5 9.28571C5 9.6808 4.6808 10 4.28571 10C3.89062 10 3.57143 9.6808 3.57143 9.28571L3.57143 5.29688L1.93304 6.93527C1.65402 7.21429 1.20089 7.21429 0.921875 6.93527C0.642857 6.65625 0.642857 6.20312 0.921875 5.92411L3.77902 3.06696L3.78125 3.06696Z"
                          fill="currentColor"
                        />
                      </svg>
                      Upload Document
                    </button>
                    <button class="kt-btn kt-btn-outline kt-btn-primary kt-btn-sm rounded-sm line-height-1 dark:bg-white dark:text-dark">
                      <svg class="w-auto h-auto dark:text-dark" width="10" height="10" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path
                          d="M6.42857 0.714286C6.42857 1.10938 6.10938 1.42857 5.71429 1.42857H0.714286C0.319196 1.42857 0 1.10938 0 0.714286C0 0.319196 0.319196 0 0.714286 0H5.71429C6.10938 0 6.42857 0.319196 6.42857 0.714286ZM6.42857 6.42857C6.42857 6.82366 6.10938 7.14286 5.71429 7.14286H0.714286C0.319196 7.14286 0 6.82366 0 6.42857C0 6.03348 0.319196 5.71429 0.714286 5.71429H5.71429C6.10938 5.71429 6.42857 6.03348 6.42857 6.42857ZM0 3.57143C0 3.17634 0.319196 2.85714 0.714286 2.85714H9.28571C9.6808 2.85714 10 3.17634 10 3.57143C10 3.96652 9.6808 4.28571 9.28571 4.28571H0.714286C0.319196 4.28571 0 3.96652 0 3.57143ZM10 9.28571C10 9.6808 9.6808 10 9.28571 10H0.714286C0.319196 10 0 9.6808 0 9.28571C0 8.89062 0.319196 8.57143 0.714286 8.57143H9.28571C9.6808 8.57143 10 8.89062 10 9.28571Z"
                          fill="currentColor"
                        />
                      </svg>
                      Add Repository
                    </button>
                  </div>
                </div>
                <div class="kt-card-group grid gap-2.5 lg:gap-2.5 p-0">
                  <div class="card flex items-start gap-3 pt-2.5 pb-5 border-b border-dashed border-gray-200">
                    <div class="flex flex-col grow gap-1 w-full">
                      <div class="flex gap-2.5 w-full">
                        <div class="min-w-[65px] w-[65px] h-[50px] flex items-center justify-center flex-col gap-1 border-2 bg-yellow-300 rounded-md dark:border-zinc-600 relative">
                          <span class="text-3xs uppercase font-inter font-medium dark:text-dark">EXHIBIT</span>
                          <span class="text-2sm font-inter font-semibold line-height-1 dark:text-dark">001</span>
                          <span class="w-[40px] h-[2px] bg-mono dark:bg-dark mt-0.5"></span>
                          <a href="">
                            <i class="ki ki-pencil"></i>
                          </a>
                        </div>
                        <div class="flex flex-col">
                          <span class="text-primary text-sm font-semibold cursor-pointer hover:text-primary -mt-0.5 line-height-1 pb-1">Document 1</span>
                          <span class="text-xs text-muted-foreground -mt-0.5 mb-1 dark:text-white">Sample PDF.pdf</span>
                          <span class="text-xs text-accent-foreground/60 mb-2">By Walter Craighead</span>
                          <div class="flex items-center gap-1.5 text-xs font-semibold uppercase">
                            <input class="kt-switch" name="param" type="checkbox" value="1" checked />
                            <span class="font-inter">Reveal</span>
                          </div>
                        </div>
                      </div>
                      <div class="flex flex-col gap-4 w-full">
                        <div data-kt-accordion="true" class="kt-accordion w-full relative">
                          <div data-kt-accordion-item="true" class="kt-accordion-item border-0">
                            <button id="accordion_toggle_documents" data-kt-accordion-toggle="true" aria-controls="accordion_content_documents" class="kt-accordion-toggle p-0 kt-btn kt-btn-outline kt-btn-primary kt-btn-sm kt-btn-icon flex relative z-1 dark:bg-white dark:text-dark">
                              <span aria-hidden="true" class="kt-accordion-indicator text-primary">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="kt-accordion-indicator-on">
                                  <path d="M5 12h14"></path>
                                  <path d="M12 5v14"></path>
                                </svg>
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="kt-accordion-indicator-off">
                                  <path d="M5 12h14"></path>
                                </svg>
                              </span>
                            </button>
                            <div class="kt-accordion-content hidden ps-8 ms-1 relative" aria-labelledby="accordion_toggle_documents" id="accordion_content_documents">
                              <div class="kt-accordion-wrapper p-0">
                                <div class="flex flex-col gap-0 relative">
                                  <span class="absolute start-[20px] top-0 bottom-0 w-[2px] border-s border-border border-dashed"></span>
                                  <div class="flex items-start gap-3 py-2.5 relative">
                                    <span class="absolute start-[20px] mt-2.5 w-5 border-t border-border border-dashed"></span>
                                    <div class="flex-shrink-0 mt-0.5 ms-5">
                                      <img class="h-5 w-5" src="assets/media/file-types/pdf.svg" alt="PDF" />
                                    </div>
                                    <div class="flex-1 min-w-0">
                                      <div class="flex items-start justify-between gap-3">
                                        <div class="flex-1">
                                          <a href="#" class="text-xs text-muted-foreground -mt-0.5 mb-1 dark:text-white block">Sample PDF.pdf</a>
                                          <span class="text-2sm text-gray-700 mb-2 block dark:text-white">By Walter Craighead</span>
                                          <div class="flex items-center gap-1.5 text-xs font-semibold uppercase">
                                            <input class="kt-switch" name="param" type="checkbox" value="1" />
                                            <span class="font-inter">Reveal</span>
                                          </div>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="flex items-start gap-3 py-2.5 relative">
                                    <span class="absolute start-[20px] mt-2.5 w-5 border-t border-border border-dashed"></span>
                                    <div class="flex-shrink-0 mt-0.5 ms-5">
                                      <img class="h-5 w-5" src="assets/media/file-types/excel.svg" alt="Excel" />
                                    </div>
                                    <div class="flex-1 min-w-0">
                                      <div class="flex items-start justify-between gap-3">
                                        <div class="flex-1">
                                          <a href="#" class="text-xs text-muted-foreground -mt-0.5 mb-1 dark:text-white block">Sample Doc</a>
                                          <span class="text-2sm text-gray-700 mb-2 block dark:text-white">By Walter Craighead</span>
                                          <div class="flex items-center gap-1.5 text-xs font-semibold uppercase">
                                            <input class="kt-switch" name="param" type="checkbox" value="1" />
                                            <span class="font-inter">Reveal</span>
                                          </div>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="kt-menu" data-kt-menu="true">
                      <div class="kt-menu-item kt-menu-item-dropdown" data-kt-menu-item-offset="0, 0" data-kt-menu-item-placement="bottom-end" data-kt-menu-item-placement-rtl="bottom-start" data-kt-menu-item-toggle="dropdown" data-kt-menu-item-trigger="click">
                        <button class="kt-menu-toggle kt-btn kt-btn-icon kt-btn-outline w-[30px] h-auto py-1 rounded-[4px]">
                          <i class="ki-filled ki-dots-vertical text-lg"></i>
                        </button>
                        <div class="kt-menu-dropdown kt-menu-default w-full max-w-[175px] -mt-1 border-1 shadow-drop bg-background dark:bg-muted" data-kt-menu-dismiss="true">
                          <div class="kt-menu-item">
                            <a class="kt-menu-link px-4" href="#">
                              <span class="kt-menu-title">Annotation Access</span>
                            </a>
                            <a class="kt-menu-link px-4" href="#">
                              <span class="kt-menu-title">Edit Stamp</span>
                            </a>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="card flex items-start gap-3 pt-2.5 pb-5 border-b border-dashed border-gray-200">
                    <div class="flex grow gap-2.5 w-full">
                      <div class="min-w-[65px] w-[65px] h-[50px] flex items-center justify-center flex-col gap-1 border-2 bg-yellow-300 rounded-md dark:border-zinc-600">
                        <span class="text-3xs uppercase font-inter font-medium dark:text-dark">EXHIBIT</span>
                        <span class="text-2sm font-inter font-semibold line-height-1 dark:text-dark">001</span>
                        <span class="w-[40px] h-[2px] bg-mono dark:bg-dark mt-0.5"></span>
                      </div>
                      <div class="flex flex-col">
                        <span class="text-mono text-sm font-semibold cursor-pointer hover:text-primary -mt-0.5 line-height-1 pb-1">Document 1</span>
                        <span class="text-xs text-muted-foreground -mt-0.5 mb-1 dark:text-white">Sample PDF.pdf</span>
                        <span class="text-xs text-accent-foreground/60 mb-2">By Walter Craighead</span>
                        <div class="flex items-center gap-1.5 text-xs font-semibold uppercase">
                          <input class="kt-switch" name="param" type="checkbox" value="1" />
                          <span class="font-inter">Reveal</span>
                        </div>
                      </div>
                    </div>
                    <div class="kt-menu" data-kt-menu="true">
                      <div class="kt-menu-item kt-menu-item-dropdown" data-kt-menu-item-offset="0, 0" data-kt-menu-item-placement="bottom-end" data-kt-menu-item-placement-rtl="bottom-start" data-kt-menu-item-toggle="dropdown" data-kt-menu-item-trigger="click">
                        <button class="kt-menu-toggle kt-btn kt-btn-icon kt-btn-outline w-[30px] h-auto py-1 rounded-[4px]">
                          <i class="ki-filled ki-dots-vertical text-lg"></i>
                        </button>
                        <div class="kt-menu-dropdown kt-menu-default w-full max-w-[175px] -mt-1 border-1 shadow-drop bg-background dark:bg-muted" data-kt-menu-dismiss="true">
                          <div class="kt-menu-item">
                            <a class="kt-menu-link px-4" href="#">
                              <span class="kt-menu-title">Annotation Access</span>
                            </a>
                            <a class="kt-menu-link px-4" href="#">
                              <span class="kt-menu-title">Edit Stamp</span>
                            </a>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="card flex items-start gap-3 pt-2.5 pb-5 border-b border-dashed border-gray-200">
                    <div class="flex grow gap-2.5 w-full">
                      <div class="min-w-[65px] w-[65px] h-[50px] flex items-center justify-center flex-col gap-1 border-2 bg-yellow-300 rounded-md dark:border-zinc-600">
                        <span class="text-3xs uppercase font-inter font-medium dark:text-dark">EXHIBIT</span>
                        <span class="text-2sm font-inter font-semibold line-height-1 dark:text-dark">001</span>
                        <span class="w-[40px] h-[2px] bg-mono dark:bg-dark mt-0.5"></span>
                      </div>
                      <div class="flex flex-col">
                        <span class="text-mono text-sm font-semibold cursor-pointer hover:text-primary -mt-0.5 line-height-1 pb-1">Document 1</span>
                        <span class="text-xs text-muted-foreground -mt-0.5 mb-1 dark:text-white">Sample PDF.pdf</span>
                        <span class="text-xs text-accent-foreground/60 mb-2">By Walter Craighead</span>
                        <div class="flex items-center gap-1.5 text-xs font-semibold uppercase">
                          <input class="kt-switch" name="param" type="checkbox" value="1" />
                          <span class="font-inter">Reveal</span>
                        </div>
                      </div>
                    </div>
                    <div class="kt-menu" data-kt-menu="true">
                      <div class="kt-menu-item kt-menu-item-dropdown" data-kt-menu-item-offset="0, 0" data-kt-menu-item-placement="bottom-end" data-kt-menu-item-placement-rtl="bottom-start" data-kt-menu-item-toggle="dropdown" data-kt-menu-item-trigger="click">
                        <button class="kt-menu-toggle kt-btn kt-btn-icon kt-btn-outline w-[30px] h-auto py-1 rounded-[4px]">
                          <i class="ki-filled ki-dots-vertical text-lg"></i>
                        </button>
                        <div class="kt-menu-dropdown kt-menu-default w-full max-w-[175px] -mt-1 border-1 shadow-drop bg-background dark:bg-muted" data-kt-menu-dismiss="true">
                          <div class="kt-menu-item">
                            <a class="kt-menu-link px-4" href="#">
                              <span class="kt-menu-title">Annotation Access</span>
                            </a>
                            <a class="kt-menu-link px-4" href="#">
                              <span class="kt-menu-title">Edit Stamp</span>
                            </a>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="card flex items-start gap-3 pt-2.5 pb-5 border-b border-dashed border-gray-200">
                    <div class="flex grow gap-2.5 w-full">
                      <div class="min-w-[65px] w-[65px] h-[50px] flex items-center justify-center flex-col gap-1 border-2 bg-yellow-300 rounded-md dark:border-zinc-600">
                        <span class="text-3xs uppercase font-inter font-medium dark:text-dark">EXHIBIT</span>
                        <span class="text-2sm font-inter font-semibold line-height-1 dark:text-dark">001</span>
                        <span class="w-[40px] h-[2px] bg-mono dark:bg-dark mt-0.5"></span>
                      </div>
                      <div class="flex flex-col">
                        <span class="text-mono text-sm font-semibold cursor-pointer hover:text-primary -mt-0.5 line-height-1 pb-1">Document 1</span>
                        <span class="text-xs text-muted-foreground -mt-0.5 mb-1 dark:text-white">Sample PDF.pdf</span>
                        <span class="text-xs text-accent-foreground/60 mb-2">By Walter Craighead</span>
                        <div class="flex items-center gap-1.5 text-xs font-semibold uppercase">
                          <input class="kt-switch" name="param" type="checkbox" value="1" />
                          <span class="font-inter">Reveal</span>
                        </div>
                      </div>
                    </div>
                    <div class="kt-menu" data-kt-menu="true">
                      <div class="kt-menu-item kt-menu-item-dropdown" data-kt-menu-item-offset="0, 0" data-kt-menu-item-placement="bottom-end" data-kt-menu-item-placement-rtl="bottom-start" data-kt-menu-item-toggle="dropdown" data-kt-menu-item-trigger="click">
                        <button class="kt-menu-toggle kt-btn kt-btn-icon kt-btn-outline w-[30px] h-auto py-1 rounded-[4px]">
                          <i class="ki-filled ki-dots-vertical text-lg"></i>
                        </button>
                        <div class="kt-menu-dropdown kt-menu-default w-full max-w-[175px] -mt-1 border-1 shadow-drop bg-background dark:bg-muted" data-kt-menu-dismiss="true">
                          <div class="kt-menu-item">
                            <a class="kt-menu-link px-4" href="#">
                              <span class="kt-menu-title">Annotation Access</span>
                            </a>
                            <a class="kt-menu-link px-4" href="#">
                              <span class="kt-menu-title">Edit Stamp</span>
                            </a>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="card flex items-start gap-3 pt-2.5 pb-5 border-b border-dashed border-gray-200">
                    <div class="flex grow gap-2.5 w-full">
                      <div class="min-w-[65px] w-[65px] h-[50px] flex items-center justify-center flex-col gap-1 border-2 bg-yellow-300 rounded-md dark:border-zinc-600">
                        <span class="text-3xs uppercase font-inter font-medium dark:text-dark">EXHIBIT</span>
                        <span class="text-2sm font-inter font-semibold line-height-1 dark:text-dark">001</span>
                        <span class="w-[40px] h-[2px] bg-mono dark:bg-dark mt-0.5"></span>
                      </div>
                      <div class="flex flex-col">
                        <span class="text-mono text-sm font-semibold cursor-pointer hover:text-primary -mt-0.5 line-height-1 pb-1">Document 1</span>
                        <span class="text-xs text-muted-foreground -mt-0.5 mb-1 dark:text-white">Sample PDF.pdf</span>
                        <span class="text-xs text-accent-foreground/60 mb-2">By Walter Craighead</span>
                        <div class="flex items-center gap-1.5 text-xs font-semibold uppercase">
                          <input class="kt-switch" name="param" type="checkbox" value="1" />
                          <span class="font-inter">Reveal</span>
                        </div>
                      </div>
                    </div>
                    <div class="kt-menu" data-kt-menu="true">
                      <div class="kt-menu-item kt-menu-item-dropdown" data-kt-menu-item-offset="0, 0" data-kt-menu-item-placement="bottom-end" data-kt-menu-item-placement-rtl="bottom-start" data-kt-menu-item-toggle="dropdown" data-kt-menu-item-trigger="click">
                        <button class="kt-menu-toggle kt-btn kt-btn-icon kt-btn-outline w-[30px] h-auto py-1 rounded-[4px]">
                          <i class="ki-filled ki-dots-vertical text-lg"></i>
                        </button>
                        <div class="kt-menu-dropdown kt-menu-default w-full max-w-[175px] -mt-1 border-1 shadow-drop bg-background dark:bg-muted" data-kt-menu-dismiss="true">
                          <div class="kt-menu-item">
                            <a class="kt-menu-link px-4" href="#">
                              <span class="kt-menu-title">Annotation Access</span>
                            </a>
                            <a class="kt-menu-link px-4" href="#">
                              <span class="kt-menu-title">Edit Stamp</span>
                            </a>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="card flex items-start gap-3 pt-2.5 pb-5 border-b border-dashed border-gray-200">
                    <div class="flex grow gap-2.5 w-full">
                      <div class="min-w-[65px] w-[65px] h-[50px] flex items-center justify-center flex-col gap-1 border-2 bg-yellow-300 rounded-md dark:border-zinc-600">
                        <span class="text-3xs uppercase font-inter font-medium dark:text-dark">EXHIBIT</span>
                        <span class="text-2sm font-inter font-semibold line-height-1 dark:text-dark">001</span>
                        <span class="w-[40px] h-[2px] bg-mono dark:bg-dark mt-0.5"></span>
                      </div>
                      <div class="flex flex-col">
                        <span class="text-mono text-sm font-semibold cursor-pointer hover:text-primary -mt-0.5 line-height-1 pb-1">Document 1</span>
                        <span class="text-xs text-muted-foreground -mt-0.5 mb-1 dark:text-white">Sample PDF.pdf</span>
                        <span class="text-xs text-accent-foreground/60 mb-2">By Walter Craighead</span>
                        <div class="flex items-center gap-1.5 text-xs font-semibold uppercase">
                          <input class="kt-switch" name="param" type="checkbox" value="1" />
                          <span class="font-inter">Reveal</span>
                        </div>
                      </div>
                    </div>
                    <div class="kt-menu" data-kt-menu="true">
                      <div class="kt-menu-item kt-menu-item-dropdown" data-kt-menu-item-offset="0, 0" data-kt-menu-item-placement="bottom-end" data-kt-menu-item-placement-rtl="bottom-start" data-kt-menu-item-toggle="dropdown" data-kt-menu-item-trigger="click">
                        <button class="kt-menu-toggle kt-btn kt-btn-icon kt-btn-outline w-[30px] h-auto py-1 rounded-[4px]">
                          <i class="ki-filled ki-dots-vertical text-lg"></i>
                        </button>
                        <div class="kt-menu-dropdown kt-menu-default w-full max-w-[175px] -mt-1 border-1 shadow-drop bg-background dark:bg-muted" data-kt-menu-dismiss="true">
                          <div class="kt-menu-item">
                            <a class="kt-menu-link px-4" href="#">
                              <span class="kt-menu-title">Annotation Access</span>
                            </a>
                            <a class="kt-menu-link px-4" href="#">
                              <span class="kt-menu-title">Edit Stamp</span>
                            </a>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="card flex items-start gap-3 pt-2.5 pb-5 border-b border-dashed border-gray-200">
                    <div class="flex grow gap-2.5 w-full">
                      <div class="min-w-[65px] w-[65px] h-[50px] flex items-center justify-center flex-col gap-1 border-2 bg-yellow-300 rounded-md dark:border-zinc-600">
                        <span class="text-3xs uppercase font-inter font-medium dark:text-dark">EXHIBIT</span>
                        <span class="text-2sm font-inter font-semibold line-height-1 dark:text-dark">001</span>
                        <span class="w-[40px] h-[2px] bg-mono dark:bg-dark mt-0.5"></span>
                      </div>
                      <div class="flex flex-col">
                        <span class="text-mono text-sm font-semibold cursor-pointer hover:text-primary -mt-0.5 line-height-1 pb-1">Document 1</span>
                        <span class="text-xs text-muted-foreground -mt-0.5 mb-1 dark:text-white">Sample PDF.pdf</span>
                        <span class="text-xs text-accent-foreground/60 mb-2">By Walter Craighead</span>
                        <div class="flex items-center gap-1.5 text-xs font-semibold uppercase">
                          <input class="kt-switch" name="param" type="checkbox" value="1" />
                          <span class="font-inter">Reveal</span>
                        </div>
                      </div>
                    </div>
                    <div class="kt-menu" data-kt-menu="true">
                      <div class="kt-menu-item kt-menu-item-dropdown" data-kt-menu-item-offset="0, 0" data-kt-menu-item-placement="bottom-end" data-kt-menu-item-placement-rtl="bottom-start" data-kt-menu-item-toggle="dropdown" data-kt-menu-item-trigger="click">
                        <button class="kt-menu-toggle kt-btn kt-btn-icon kt-btn-outline w-[30px] h-auto py-1 rounded-[4px]">
                          <i class="ki-filled ki-dots-vertical text-lg"></i>
                        </button>
                        <div class="kt-menu-dropdown kt-menu-default w-full max-w-[175px] -mt-1 border-1 shadow-drop bg-background dark:bg-muted" data-kt-menu-dismiss="true">
                          <div class="kt-menu-item">
                            <a class="kt-menu-link px-4" href="#">
                              <span class="kt-menu-title">Annotation Access</span>
                            </a>
                            <a class="kt-menu-link px-4" href="#">
                              <span class="kt-menu-title">Edit Stamp</span>
                            </a>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="splitter-bar w-full h-1.5 relative cursor-row-resize flex items-center justify-center gap-2.5 py-0.5 bg-muted" data-splitter-bar="true">
                <span class="w-1 h-1 rounded-full bg-gray-500 opacity-0 group-hover:opacity-100 transition-opacity"></span>
                <span class="w-1 h-1 rounded-full bg-gray-500 opacity-0 group-hover:opacity-100 transition-opacity"></span>
                <span class="w-1 h-1 rounded-full bg-gray-500 opacity-0 group-hover:opacity-100 transition-opacity"></span>
              </div>
              <div id="second_documents_accordion" class="splitter-pane h-half flex-grow-1 bg-background rounded-lg px-4 py-4 pt-0 kt-scrollable-y-auto min-w-[300px]" data-splitter-pane="bottom">
                <div data-kt-accordion="true" class="kt-accordion w-full relative">
                  <div data-kt-accordion-item="true" class="kt-accordion-item border-0 active">
                    <button id="accordion_toggle_second_doc" data-kt-accordion-toggle="true" aria-controls="accordion_content_second_documents" class="kt-accordion-toggle sticky top-0 bg-background pt-4 pb-4 z-1 w-full">
                      <span class="text-base font-semibold leading-5 tracking-normal mt-1 text-nowrap">Opp-Counsel Documents</span>
                      <span aria-hidden="true" class="kt-accordion-indicator kt-btn kt-btn-outline kt-btn-primary kt-btn-sm kt-btn-icon dark:bg-white dark:text-dark">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="kt-accordion-indicator-on">
                          <path d="M5 12h14"></path>
                          <path d="M12 5v14"></path>
                        </svg>
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="kt-accordion-indicator-off">
                          <path d="M5 12h14"></path>
                        </svg>
                      </span>
                    </button>
                    <div class="kt-accordion-content" aria-labelledby="accordion_toggle_second_doc" id="accordion_content_second_documents">
                      <div class="kt-accordion-wrapper">
                        <div class="kt-card-group grid gap-2.5 lg:gap-2.5 p-0">
                          <div class="card flex items-start gap-3 pt-2.5 pb-5 border-b border-dashed border-gray-200">
                            <div class="flex grow gap-2.5">
                              <div class="min-w-[65px] w-[65px] h-[50px] flex items-center justify-center flex-col gap-1 border-2 bg-yellow-300 rounded-md dark:border-zinc-600">
                                <span class="text-3xs uppercase font-inter font-medium dark:text-dark">EXHIBIT</span>
                                <span class="text-2sm font-inter font-semibold line-height-1 dark:text-dark">001</span>
                                <span class="w-[40px] h-[2px] bg-mono dark:bg-dark mt-0.5"></span>
                              </div>
                              <div class="flex flex-col">
                                <span class="text-mono text-sm font-semibold cursor-pointer hover:text-primary -mt-0.5 line-height-1 pb-1">Document 1</span>
                                <span class="text-xs text-muted-foreground -mt-0.5 mb-1 dark:text-white">Sample PDF.pdf</span>
                                <span class="text-xs text-accent-foreground/60 mb-2">By Walter Craighead</span>
                                <div class="flex items-center gap-1.5 text-xs font-semibold uppercase">
                                  <input class="kt-switch" name="param" type="checkbox" value="1" />
                                  <span class="font-inter">Reveal</span>
                                </div>
                              </div>
                            </div>
                            <div class="kt-menu" data-kt-menu="true">
                              <div class="kt-menu-item kt-menu-item-dropdown" data-kt-menu-item-offset="0, 0" data-kt-menu-item-placement="bottom-end" data-kt-menu-item-placement-rtl="bottom-start" data-kt-menu-item-toggle="dropdown" data-kt-menu-item-trigger="click">
                                <button class="kt-menu-toggle kt-btn kt-btn-icon kt-btn-outline w-[30px] h-auto py-1 rounded-[4px]">
                                  <i class="ki-filled ki-dots-vertical text-lg"></i>
                                </button>
                                <div class="kt-menu-dropdown kt-menu-default w-full max-w-[175px] -mt-1 border-1 shadow-drop bg-background dark:bg-muted" data-kt-menu-dismiss="true">
                                  <div class="kt-menu-item">
                                    <a class="kt-menu-link px-4" href="#">
                                      <span class="kt-menu-title">Annotation Access</span>
                                    </a>
                                    <a class="kt-menu-link px-4" href="#">
                                      <span class="kt-menu-title">Edit Stamp</span>
                                    </a>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="card flex items-start gap-3 pt-2.5 pb-5 border-b border-dashed border-gray-200">
                            <div class="flex grow gap-2.5">
                              <div class="min-w-[65px] w-[65px] h-[50px] flex items-center justify-center flex-col gap-1 border-2 bg-yellow-300 rounded-md dark:border-zinc-600">
                                <span class="text-3xs uppercase font-inter font-medium dark:text-dark">EXHIBIT</span>
                                <span class="text-2sm font-inter font-semibold line-height-1 dark:text-dark">001</span>
                                <span class="w-[40px] h-[2px] bg-mono dark:bg-dark mt-0.5"></span>
                              </div>
                              <div class="flex flex-col">
                                <span class="text-mono text-sm font-semibold cursor-pointer hover:text-primary -mt-0.5 line-height-1 pb-1">Document 1</span>
                                <span class="text-xs text-muted-foreground -mt-0.5 mb-1 dark:text-white">Sample PDF.pdf</span>
                                <span class="text-xs text-accent-foreground/60 mb-2">By Walter Craighead</span>
                                <div class="flex items-center gap-1.5 text-xs font-semibold uppercase">
                                  <input class="kt-switch" name="param" type="checkbox" value="1" />
                                  <span class="font-inter">Reveal</span>
                                </div>
                              </div>
                            </div>
                            <div class="kt-menu" data-kt-menu="true">
                              <div class="kt-menu-item kt-menu-item-dropdown" data-kt-menu-item-offset="0, 0" data-kt-menu-item-placement="bottom-end" data-kt-menu-item-placement-rtl="bottom-start" data-kt-menu-item-toggle="dropdown" data-kt-menu-item-trigger="click">
                                <button class="kt-menu-toggle kt-btn kt-btn-icon kt-btn-outline w-[30px] h-auto py-1 rounded-[4px]">
                                  <i class="ki-filled ki-dots-vertical text-lg"></i>
                                </button>
                                <div class="kt-menu-dropdown kt-menu-default w-full max-w-[175px] -mt-1 border-1 shadow-drop bg-background dark:bg-muted" data-kt-menu-dismiss="true">
                                  <div class="kt-menu-item">
                                    <a class="kt-menu-link px-4" href="#">
                                      <span class="kt-menu-title">Annotation Access</span>
                                    </a>
                                    <a class="kt-menu-link px-4" href="#">
                                      <span class="kt-menu-title">Edit Stamp</span>
                                    </a>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="card flex items-start gap-3 pt-2.5 pb-5 border-b border-dashed border-gray-200">
                            <div class="flex grow gap-2.5">
                              <div class="min-w-[65px] w-[65px] h-[50px] flex items-center justify-center flex-col gap-1 border-2 bg-yellow-300 rounded-md dark:border-zinc-600">
                                <span class="text-3xs uppercase font-inter font-medium dark:text-dark">EXHIBIT</span>
                                <span class="text-2sm font-inter font-semibold line-height-1 dark:text-dark">001</span>
                                <span class="w-[40px] h-[2px] bg-mono dark:bg-dark mt-0.5"></span>
                              </div>
                              <div class="flex flex-col">
                                <span class="text-mono text-sm font-semibold cursor-pointer hover:text-primary -mt-0.5 line-height-1 pb-1">Document 1</span>
                                <span class="text-xs text-muted-foreground -mt-0.5 mb-1 dark:text-white">Sample PDF.pdf</span>
                                <span class="text-xs text-accent-foreground/60 mb-2">By Walter Craighead</span>
                                <div class="flex items-center gap-1.5 text-xs font-semibold uppercase">
                                  <input class="kt-switch" name="param" type="checkbox" value="1" />
                                  <span class="font-inter">Reveal</span>
                                </div>
                              </div>
                            </div>
                            <div class="kt-menu" data-kt-menu="true">
                              <div class="kt-menu-item kt-menu-item-dropdown" data-kt-menu-item-offset="0, 0" data-kt-menu-item-placement="bottom-end" data-kt-menu-item-placement-rtl="bottom-start" data-kt-menu-item-toggle="dropdown" data-kt-menu-item-trigger="click">
                                <button class="kt-menu-toggle kt-btn kt-btn-icon kt-btn-outline w-[30px] h-auto py-1 rounded-[4px]">
                                  <i class="ki-filled ki-dots-vertical text-lg"></i>
                                </button>
                                <div class="kt-menu-dropdown kt-menu-default w-full max-w-[175px] -mt-1 border-1 shadow-drop bg-background dark:bg-muted" data-kt-menu-dismiss="true">
                                  <div class="kt-menu-item">
                                    <a class="kt-menu-link px-4" href="#">
                                      <span class="kt-menu-title">Annotation Access</span>
                                    </a>
                                    <a class="kt-menu-link px-4" href="#">
                                      <span class="kt-menu-title">Edit Stamp</span>
                                    </a>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="card flex items-start gap-3 pt-2.5 pb-5 border-b border-dashed border-gray-200">
                            <div class="flex grow gap-2.5">
                              <div class="min-w-[65px] w-[65px] h-[50px] flex items-center justify-center flex-col gap-1 border-2 bg-yellow-300 rounded-md dark:border-zinc-600">
                                <span class="text-3xs uppercase font-inter font-medium dark:text-dark">EXHIBIT</span>
                                <span class="text-2sm font-inter font-semibold line-height-1 dark:text-dark">001</span>
                                <span class="w-[40px] h-[2px] bg-mono dark:bg-dark mt-0.5"></span>
                              </div>
                              <div class="flex flex-col">
                                <span class="text-mono text-sm font-semibold cursor-pointer hover:text-primary -mt-0.5 line-height-1 pb-1">Document 1</span>
                                <span class="text-xs text-muted-foreground -mt-0.5 mb-1 dark:text-white">Sample PDF.pdf</span>
                                <span class="text-xs text-accent-foreground/60 mb-2">By Walter Craighead</span>
                                <div class="flex items-center gap-1.5 text-xs font-semibold uppercase">
                                  <input class="kt-switch" name="param" type="checkbox" value="1" />
                                  <span class="font-inter">Reveal</span>
                                </div>
                              </div>
                            </div>
                            <div class="kt-menu" data-kt-menu="true">
                              <div class="kt-menu-item kt-menu-item-dropdown" data-kt-menu-item-offset="0, 0" data-kt-menu-item-placement="bottom-end" data-kt-menu-item-placement-rtl="bottom-start" data-kt-menu-item-toggle="dropdown" data-kt-menu-item-trigger="click">
                                <button class="kt-menu-toggle kt-btn kt-btn-icon kt-btn-outline w-[30px] h-auto py-1 rounded-[4px]">
                                  <i class="ki-filled ki-dots-vertical text-lg"></i>
                                </button>
                                <div class="kt-menu-dropdown kt-menu-default w-full max-w-[175px] -mt-1 border-1 shadow-drop bg-background dark:bg-muted" data-kt-menu-dismiss="true">
                                  <div class="kt-menu-item">
                                    <a class="kt-menu-link px-4" href="#">
                                      <span class="kt-menu-title">Annotation Access</span>
                                    </a>
                                    <a class="kt-menu-link px-4" href="#">
                                      <span class="kt-menu-title">Edit Stamp</span>
                                    </a>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="card flex items-start gap-3 pt-2.5 pb-5 border-b border-dashed border-gray-200">
                            <div class="flex grow gap-2.5">
                              <div class="min-w-[65px] w-[65px] h-[50px] flex items-center justify-center flex-col gap-1 border-2 bg-yellow-300 rounded-md dark:border-zinc-600">
                                <span class="text-3xs uppercase font-inter font-medium dark:text-dark">EXHIBIT</span>
                                <span class="text-2sm font-inter font-semibold line-height-1 dark:text-dark">001</span>
                                <span class="w-[40px] h-[2px] bg-mono dark:bg-dark mt-0.5"></span>
                              </div>
                              <div class="flex flex-col">
                                <span class="text-mono text-sm font-semibold cursor-pointer hover:text-primary -mt-0.5 line-height-1 pb-1">Document 1</span>
                                <span class="text-xs text-muted-foreground -mt-0.5 mb-1 dark:text-white">Sample PDF.pdf</span>
                                <span class="text-xs text-accent-foreground/60 mb-2">By Walter Craighead</span>
                                <div class="flex items-center gap-1.5 text-xs font-semibold uppercase">
                                  <input class="kt-switch" name="param" type="checkbox" value="1" />
                                  <span class="font-inter">Reveal</span>
                                </div>
                              </div>
                            </div>
                            <div class="kt-menu" data-kt-menu="true">
                              <div class="kt-menu-item kt-menu-item-dropdown" data-kt-menu-item-offset="0, 0" data-kt-menu-item-placement="bottom-end" data-kt-menu-item-placement-rtl="bottom-start" data-kt-menu-item-toggle="dropdown" data-kt-menu-item-trigger="click">
                                <button class="kt-menu-toggle kt-btn kt-btn-icon kt-btn-outline w-[30px] h-auto py-1 rounded-[4px]">
                                  <i class="ki-filled ki-dots-vertical text-lg"></i>
                                </button>
                                <div class="kt-menu-dropdown kt-menu-default w-full max-w-[175px] -mt-1 border-1 shadow-drop bg-background dark:bg-muted" data-kt-menu-dismiss="true">
                                  <div class="kt-menu-item">
                                    <a class="kt-menu-link px-4" href="#">
                                      <span class="kt-menu-title">Annotation Access</span>
                                    </a>
                                    <a class="kt-menu-link px-4" href="#">
                                      <span class="kt-menu-title">Edit Stamp</span>
                                    </a>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="card flex items-start gap-3 pt-2.5 pb-5 border-b border-dashed border-gray-200">
                            <div class="flex grow gap-2.5">
                              <div class="min-w-[65px] w-[65px] h-[50px] flex items-center justify-center flex-col gap-1 border-2 bg-yellow-300 rounded-md dark:border-zinc-600">
                                <span class="text-3xs uppercase font-inter font-medium dark:text-dark">EXHIBIT</span>
                                <span class="text-2sm font-inter font-semibold line-height-1 dark:text-dark">001</span>
                                <span class="w-[40px] h-[2px] bg-mono dark:bg-dark mt-0.5"></span>
                              </div>
                              <div class="flex flex-col">
                                <span class="text-mono text-sm font-semibold cursor-pointer hover:text-primary -mt-0.5 line-height-1 pb-1">Document 1</span>
                                <span class="text-xs text-muted-foreground -mt-0.5 mb-1 dark:text-white">Sample PDF.pdf</span>
                                <span class="text-xs text-accent-foreground/60 mb-2">By Walter Craighead</span>
                                <div class="flex items-center gap-1.5 text-xs font-semibold uppercase">
                                  <input class="kt-switch" name="param" type="checkbox" value="1" />
                                  <span class="font-inter">Reveal</span>
                                </div>
                              </div>
                            </div>
                            <div class="kt-menu" data-kt-menu="true">
                              <div class="kt-menu-item kt-menu-item-dropdown" data-kt-menu-item-offset="0, 0" data-kt-menu-item-placement="bottom-end" data-kt-menu-item-placement-rtl="bottom-start" data-kt-menu-item-toggle="dropdown" data-kt-menu-item-trigger="click">
                                <button class="kt-menu-toggle kt-btn kt-btn-icon kt-btn-outline w-[30px] h-auto py-1 rounded-[4px]">
                                  <i class="ki-filled ki-dots-vertical text-lg"></i>
                                </button>
                                <div class="kt-menu-dropdown kt-menu-default w-full max-w-[175px] -mt-1 border-1 shadow-drop bg-background dark:bg-muted" data-kt-menu-dismiss="true">
                                  <div class="kt-menu-item">
                                    <a class="kt-menu-link px-4" href="#">
                                      <span class="kt-menu-title">Annotation Access</span>
                                    </a>
                                    <a class="kt-menu-link px-4" href="#">
                                      <span class="kt-menu-title">Edit Stamp</span>
                                    </a>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="card flex items-start gap-3 pt-2.5 pb-5 border-b border-dashed border-gray-200">
                            <div class="flex grow gap-2.5">
                              <div class="min-w-[65px] w-[65px] h-[50px] flex items-center justify-center flex-col gap-1 border-2 bg-yellow-300 rounded-md dark:border-zinc-600">
                                <span class="text-3xs uppercase font-inter font-medium dark:text-dark">EXHIBIT</span>
                                <span class="text-2sm font-inter font-semibold line-height-1 dark:text-dark">001</span>
                                <span class="w-[40px] h-[2px] bg-mono dark:bg-dark mt-0.5"></span>
                              </div>
                              <div class="flex flex-col">
                                <span class="text-mono text-sm font-semibold cursor-pointer hover:text-primary -mt-0.5 line-height-1 pb-1">Document 1</span>
                                <span class="text-xs text-muted-foreground -mt-0.5 mb-1 dark:text-white">Sample PDF.pdf</span>
                                <span class="text-xs text-accent-foreground/60 mb-2">By Walter Craighead</span>
                                <div class="flex items-center gap-1.5 text-xs font-semibold uppercase">
                                  <input class="kt-switch" name="param" type="checkbox" value="1" />
                                  <span class="font-inter">Reveal</span>
                                </div>
                              </div>
                            </div>
                            <div class="kt-menu" data-kt-menu="true">
                              <div class="kt-menu-item kt-menu-item-dropdown" data-kt-menu-item-offset="0, 0" data-kt-menu-item-placement="bottom-end" data-kt-menu-item-placement-rtl="bottom-start" data-kt-menu-item-toggle="dropdown" data-kt-menu-item-trigger="click">
                                <button class="kt-menu-toggle kt-btn kt-btn-icon kt-btn-outline w-[30px] h-auto py-1 rounded-[4px]">
                                  <i class="ki-filled ki-dots-vertical text-lg"></i>
                                </button>
                                <div class="kt-menu-dropdown kt-menu-default w-full max-w-[175px] -mt-1 border-1 shadow-drop bg-background dark:bg-muted" data-kt-menu-dismiss="true">
                                  <div class="kt-menu-item">
                                    <a class="kt-menu-link px-4" href="#">
                                      <span class="kt-menu-title">Annotation Access</span>
                                    </a>
                                    <a class="kt-menu-link px-4" href="#">
                                      <span class="kt-menu-title">Edit Stamp</span>
                                    </a>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </aside>
          <div id="kt_splitter_middle_left_bar" class="splitter-bar w-1.5 h-full relative cursor-col-resize flex items-center justify-center gap-2.5 px-0.5 group" data-splitter-bar>
            <span class="h-1 w-1 rounded-full bg-gray-500 opacity-0 group-hover:opacity-100 transition-opacity"></span>
            <span class="h-1 w-1 rounded-full bg-gray-500 opacity-0 group-hover:opacity-100 transition-opacity"></span>
            <span class="h-1 w-1 rounded-full bg-gray-500 opacity-0 group-hover:opacity-100 transition-opacity"></span>
          </div>
          <div id="kt_splitter_middle_vertical" class="splitter flex-1 h-full flex flex-col relative splitter-pane">
            <!-- <div class="absolute -top-1 left-1/2 -translate-x-1/2 z-4">
              <span class="kt-badge kt-badge-success kt-badge-light kt-badge-lg px-3 py-1.5 font-semibold shadow-sm">Document 1</span>
            </div> -->
            <button id="kt_aside_toggle_left" class="kt-btn kt-btn-outline kt-btn-icon start-full size-[30px] h-[36px] absolute left-0 top-[15%] z-1 bg-muted" data-kt-toggle="true" data-kt-toggle-state="active" data-kt-toggle-target="body" data-kt-toggle-name="aside-minimize">
              <i class="ki-duotone ki-double-left fs-3 transition-transform duration-300">
                <span class="path1"></span>
                <span class="path2"></span>
              </i>
            </button>
            <button id="kt_aside_toggle_right" class="kt-btn kt-btn-outline kt-btn-icon size-[30px] h-[36px] absolute right-0 top-[15%] z-1 bg-muted" data-kt-toggle="true" data-kt-toggle-state="active" data-kt-toggle-target="body" data-kt-toggle-name="aside-minimize-right">
              <i class="ki-duotone ki-double-right fs-3 transition-transform duration-300">
                <span class="path1"></span>
                <span class="path2"></span>
              </i>
            </button>
            <div class="card bg-background rounded-lg kt-scrollable-y-auto h-full! flex flex-col flex-shrink" data-splitter-pane="top" style="flex-shrink: 1 !important">
              <!-- <img alt="" class="w-full h-auto shrink-0 rounded-lg" src="assets/media/images/pdf-img.png" /> -->
              <div class="card-body flex flex-col justify-between pb-0 overflow-hidden">
                <div class="flex flex-col flex-1 overflow-hidden" id="kt_content">
                  <div class="app h-full min-h-[400px] overflow-hidden grid">
                    <div class="flex items-center justify-between gap-3 px-2 py-2 border-b border-gray-200 bg-background" id="divToolbar">
                      <div class="flex items-center gap-2">

                        <div class="flex items-center border border-border rounded-md" id="penStack">
                          <div class="kt-menu" data-kt-menu="true">
                            <div class="kt-menu-item kt-menu-item-dropdown flex flex-row" data-kt-menu-item-offset="0, 0" data-kt-menu-item-placement="bottom-start" data-kt-menu-item-toggle="dropdown" data-kt-menu-item-trigger="click">
                              <button class="kt-btn kt-btn-outline kt-btn-primary kt-btn-sm border-0 dark:bg-white dark:text-dark" id="tool-pen" type="button" aria-label="Pen" title="Pen">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="#000000" width="800px" height="800px" viewBox="0 0 24 24">
                                  <path
                                    fill="currentColor"
                                    d="M12.336,1.293a1,1,0,0,0-1.414,0L7.959,4.256a1,1,0,0,0,0,1.414L9.778,7.489,2.423,9.94a1,1,0,0,0-.681.882L1,21.934a1.151,1.151,0,0,0,.291.773A1.006,1.006,0,0,0,2.065,23l11.112-.741a1,1,0,0,0,.883-.681l2.451-7.354,1.819,1.819a1,1,0,0,0,1.414,0l2.963-2.964a1,1,0,0,0,0-1.414Zm.038,19.013-7.786.519,3.464-3.464a3.057,3.057,0,0,0,3.543-.58,3.1,3.1,0,0,0,0-4.377,3.17,3.17,0,0,0-4.378,0,3.09,3.09,0,0,0-.58,3.543L3.174,19.411l.519-7.786L11.359,9.07l3.571,3.571ZM8.633,15.367a1.1,1.1,0,1,1,1.548,0A1.095,1.095,0,0,1,8.633,15.367Zm10.4-1.447-2.255-2.255v0L12.336,7.219l0,0L10.08,4.963l1.549-1.549,8.957,8.956Z"
                                  /> 
                                </svg>
                                <span>Pen</span>
                              </button>
                              <span class="kt-menu-toggle kt-btn-icon text-muted-foreground border-0 px-1.5" type="button">
                                <i class="ki-solid ki-down"></i>
                              </span>
                              <div class="kt-menu-dropdown kt-menu-default px-3 py-3 w-full max-w-[200px] border-1 shadow-drop bg-background dark:bg-muted show" onclick="event.stopPropagation();">
                                <div class="flex flex-col gap-2">
                                  <div class="flex items-center gap-2">
                                    <span class="text-xs text-muted-foreground dark:text-white">Color:</span>
                                    <input id="penColor" type="color" value="#111827" aria-label="Pen color" />
                                  </div>
                                  <div class="flex items-center gap-2">
                                    <span class="text-xs text-muted-foreground dark:text-white">Width:</span>
                                    <input id="penWidth" type="range" min="1" max="16" step="1" value="3" aria-label="Pen width" />
                                    <span class="text-xs text-muted-foreground dark:text-white" id="penWidthValue">3px</span>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="flex items-center border border-border rounded-md" id="highStack">
                          <div class="kt-menu" data-kt-menu="true">
                            <div class="kt-menu-item kt-menu-item-dropdown flex flex-row" data-kt-menu-item-offset="0, 0" data-kt-menu-item-placement="bottom-start" data-kt-menu-item-toggle="dropdown" data-kt-menu-item-trigger="click">
                              <button class="kt-btn kt-btn-outline kt-btn-primary kt-btn-sm border-0" id="tool-high" type="button" aria-label="Highlighter" title="Highlighter">
                                <svg class="rotate-180" xmlns="http://www.w3.org/2000/svg" width="14px" height="14px" viewBox="0 0 24 24">
                                  <path d="M15 9.361v-7.6l-6 2.4v5.2l-3 5V23h1v-8h10v8h1v-8.639zm-5-4.523l4-1.6V7h-4zm0 4.8V8h4v1.639L16.617 14H7.383z" stroke="currentColor" />
                                  <path fill="none" d="M0 0h24v24H0z" />
                                </svg>
                                <span>Highlight</span>
                              </button>
                              <span class="kt-menu-toggle kt-btn-icon text-muted-foreground border-0 px-1.5" type="button">
                                <i class="ki-solid ki-down"></i>
                              </span>
                              <div class="kt-menu-dropdown kt-menu-default px-3 py-3 w-full max-w-[175px] border-1 shadow-drop bg-background dark:bg-muted" onclick="event.stopPropagation();">
                                <div class="flex items-center gap-2">
                                  <span class="text-xs text-muted-foreground dark:text-white">Color:</span>
                                  <input id="highColor" type="color" value="#ffe600" aria-label="Highlighter color" />
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="flex items-center border border-border rounded-md" id="textStack">
                          <div class="kt-menu" data-kt-menu="true">
                            <div class="kt-menu-item kt-menu-item-dropdown flex flex-row" data-kt-menu-item-offset="5, 5" data-kt-menu-item-placement="bottom-start" data-kt-menu-item-toggle="dropdown" data-kt-menu-item-trigger="click">
                              <button class="kt-btn kt-btn-outline kt-btn-primary kt-btn-sm border-0" id="tool-text" type="button" aria-label="Text tool" title="Text">
                                <svg width="14px" height="14px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                  <path
                                    d="M11.25 17C11.25 17.4142 11.5858 17.75 12 17.75C12.4142 17.75 12.75 17.4142 12.75 17H11.25ZM15.25 9.75C15.25 10.1642 15.5858 10.5 16 10.5C16.4142 10.5 16.75 10.1642 16.75 9.75H15.25ZM7.25 9.75C7.25 10.1642 7.58579 10.5 8 10.5C8.41421 10.5 8.75 10.1642 8.75 9.75H7.25ZM15.7071 7.32544L16.2646 6.82371V6.82371L15.7071 7.32544ZM9.5 16.25C9.08579 16.25 8.75 16.5858 8.75 17C8.75 17.4142 9.08579 17.75 9.5 17.75V16.25ZM15 17.75C15.4142 17.75 15.75 17.4142 15.75 17C15.75 16.5858 15.4142 16.25 15 16.25V17.75ZM10 7.75H12V6.25H10V7.75ZM12 7.75H14V6.25H12V7.75ZM12.75 17V7H11.25V17H12.75ZM15.25 9.22222V9.75H16.75V9.22222H15.25ZM7.25 9.22222V9.75H8.75V9.22222H7.25ZM14 7.75C14.4949 7.75 14.7824 7.75196 14.9865 7.78245C15.0783 7.79617 15.121 7.8118 15.1376 7.8194C15.148 7.82415 15.1477 7.82503 15.1496 7.82716L16.2646 6.82371C15.96 6.4853 15.579 6.35432 15.2081 6.29891C14.8676 6.24804 14.4479 6.25 14 6.25V7.75ZM16.75 9.22222C16.75 8.71757 16.7513 8.27109 16.708 7.91294C16.6629 7.54061 16.559 7.15082 16.2646 6.82371L15.1496 7.82716C15.1523 7.83015 15.1609 7.83939 15.1731 7.87221C15.1873 7.91048 15.2048 7.97725 15.2188 8.09313C15.2487 8.34011 15.25 8.67931 15.25 9.22222H16.75ZM10 6.25C9.55208 6.25 9.13244 6.24804 8.79192 6.29891C8.42102 6.35432 8.04 6.4853 7.73542 6.82371L8.85036 7.82716C8.85228 7.82503 8.85204 7.82415 8.86242 7.8194C8.87904 7.8118 8.92168 7.79617 9.01354 7.78245C9.21765 7.75196 9.50511 7.75 10 7.75V6.25ZM8.75 9.22222C8.75 8.67931 8.75129 8.34011 8.78118 8.09313C8.7952 7.97725 8.81273 7.91048 8.8269 7.87221C8.83905 7.83939 8.84767 7.83015 8.85036 7.82716L7.73542 6.82371C7.44103 7.15082 7.3371 7.54061 7.29204 7.91294C7.24871 8.27109 7.25 8.71757 7.25 9.22222H8.75ZM9.5 17.75H15V16.25H9.5V17.75Z"
                                    fill="currentColor"
                                  />
                                  <path d="M22 12C22 16.714 22 19.0711 20.5355 20.5355C19.0711 22 16.714 22 12 22C7.28595 22 4.92893 22 3.46447 20.5355C2 19.0711 2 16.714 2 12C2 7.28595 2 4.92893 3.46447 3.46447C4.92893 2 7.28595 2 12 2C16.714 2 19.0711 2 20.5355 3.46447C21.5093 4.43821 21.8356 5.80655 21.9449 8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
                                </svg>
                                <span>Text</span>
                              </button>
                              <span class="kt-menu-toggle kt-btn-icon text-muted-foreground border-0 px-1.5" type="button">
                                <i class="ki-solid ki-down"></i>
                              </span>
                              <div class="kt-menu-dropdown kt-menu-default px-3 py-3 w-full max-w-[175px] border-1 shadow-drop bg-background dark:bg-muted" onclick="event.stopPropagation();">
                                <div class="flex flex-col gap-2">
                                  <div class="flex items-center gap-2">
                                    <span class="text-xs text-muted-foreground dark:text-white">Color:</span>
                                    <input id="textColor" type="color" value="#111827" aria-label="Text color" style="width: 40px; height: 32px; cursor: pointer" />
                                  </div>
                                  <div class="flex items-center gap-2">
                                    <span class="text-xs text-muted-foreground dark:text-white">Size:</span>
                                    <button class="kt-btn kt-btn-outline kt-btn-sm" id="fontDec" type="button" aria-label="Decrease font size">A</button>
                                    <button class="kt-btn kt-btn-outline kt-btn-sm" id="fontInc" type="button" aria-label="Increase font size">A+</button>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="flex items-center gap-2" id="selectImage">
                          <button class="kt-btn kt-btn-outline kt-btn-primary kt-btn-sm" id="tool-select" type="button" aria-pressed="true" aria-label="Select tool" title="Select">
                            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000000" height="14px" width="14px" version="1.1" viewBox="0 0 24 24" xml:space="preserve">
                              <g id="select">
                                <path d="M14.8,24l-3.3-4.3l-3.2,4.2L5.8,6.9l16,7.2L16.4,16l3.2,4.3L14.8,24z M11.6,16.4l3.6,4.8l1.6-1.3L13.1,15l3.3-1.1l-8.1-3.6   l1.3,8.7L11.6,16.4z" fill="currentColor" />
                                <path d="M4,18H0v-4h2v2h2V18z M2,12H0V6h2V12z M18,10h-2V6h2V10z M18,4h-2V2h-2V0h4V4z M2,4H0V0h4v2H2V4z M12,2H6V0h6V2z" fill="currentColor" />
                              </g>
                            </svg>
                          </button>
                          <label class="kt-btn kt-btn-outline kt-btn-primary kt-btn-sm" for="img-file" aria-label="Insert image" title="Insert Image">
                            <svg xmlns="http://www.w3.org/2000/svg" width="14px" height="14px" viewBox="0 0 24 24" fill="none">
                              <path fill-rule="evenodd" clip-rule="evenodd" d="M23 4C23 2.34315 21.6569 1 20 1H4C2.34315 1 1 2.34315 1 4V20C1 21.6569 2.34315 23 4 23H20C21.6569 23 23 21.6569 23 20V4ZM21 4C21 3.44772 20.5523 3 20 3H4C3.44772 3 3 3.44772 3 4V20C3 20.5523 3.44772 21 4 21H20C20.5523 21 21 20.5523 21 20V4Z" fill="currentColor" />
                              <path d="M4.80665 17.5211L9.1221 9.60947C9.50112 8.91461 10.4989 8.91461 10.8779 9.60947L14.0465 15.4186L15.1318 13.5194C15.5157 12.8476 16.4843 12.8476 16.8682 13.5194L19.1451 17.5039C19.526 18.1705 19.0446 19 18.2768 19H5.68454C4.92548 19 4.44317 18.1875 4.80665 17.5211Z" fill="currentColor" />
                              <path d="M18 8C18 9.10457 17.1046 10 16 10C14.8954 10 14 9.10457 14 8C14 6.89543 14.8954 6 16 6C17.1046 6 18 6.89543 18 8Z" fill="currentColor" />
                            </svg>
                          </label>
                          <input id="img-file" type="file" accept="image/*" style="display: none" />
                        </div>
                      </div>

                      <div class="flex items-center gap-2">
                        <div class="flex items-center gap-1">
                          <button class="kt-btn kt-btn-icon kt-btn-sm kt-btn-outline" id="zoomOut" type="button" aria-label="Zoom out" title="Zoom Out">
                            <i class="ki-filled ki-minus"></i>
                          </button>
                          <span id="zoomLabel" class="px-2 text-muted-foreground text-xs fw-semibold" style="min-width: 50px; text-align: center" aria-live="polite">100%</span>
                          <button class="kt-btn kt-btn-icon kt-btn-sm kt-btn-outline" id="zoomIn" type="button" aria-label="Zoom in" title="Zoom In">
                            <i class="ki-filled ki-plus"></i>
                          </button>
                          <button class="kt-btn kt-btn-sm kt-btn-outline ms-1" id="zoomReset" type="button" aria-label="Reset zoom" title="Reset Zoom">Reset</button>
                        </div>

                        <div class="kt-menu" data-kt-menu="true" style="display: none">
                          <div class="kt-menu-item kt-menu-item-dropdown" data-kt-menu-item-offset="5, 5" data-kt-menu-item-placement="bottom-end" data-kt-menu-item-placement-rtl="bottom-start" data-kt-menu-item-toggle="dropdown" data-kt-menu-item-trigger="click">
                            <button class="kt-menu-toggle kt-btn kt-btn-icon kt-btn-outline kt-btn-sm" type="button" title="More Options">
                              <i class="ki-filled ki-dots-vertical"></i>
                            </button>
                            <div class="kt-menu-dropdown kt-menu-default" data-kt-menu-dismiss="true">
                              <div class="kt-menu-item">
                                <label class="kt-menu-link px-4 py-2" for="file">
                                  <i class="ki-filled ki-file-up me-2"></i>
                                  <span class="kt-menu-title">Open PDF</span>
                                </label>
                                <input id="file" type="file" accept="application/pdf" style="display: none" />
                              </div>
                              <div class="kt-menu-item">
                                <button class="kt-menu-link px-4 py-2 w-100 text-start" id="export" type="button">
                                  <i class="ki-filled ki-file-down me-2"></i>
                                  <span class="kt-menu-title">Export PDF</span>
                                </button>
                              </div>
                              <div class="kt-menu-item">
                                <button class="kt-menu-link px-4 py-2 w-100 text-start" id="downloadLog" type="button">
                                  <i class="ki-filled ki-file-sheet me-2"></i>
                                  <span class="kt-menu-title">Download Log</span>
                                </button>
                              </div>
                              <div class="kt-menu-item">
                                <label class="kt-menu-link px-4 py-2" for="import-json">
                                  <i class="ki-filled ki-file-added me-2"></i>
                                  <span class="kt-menu-title">Import JSON</span>
                                </label>
                                <input id="import-json" type="file" accept="application/json" style="display: none" />
                              </div>
                              <div class="kt-menu-separator"></div>
                              <div class="kt-menu-item">
                                <div class="kt-menu-link px-4 py-2" id="searchField" style="display: none" onclick="event.stopPropagation();">
                                  <div class="flex items-center gap-2 mb-2">
                                    <i class="ki-filled ki-magnifier text-muted-foreground"></i>
                                    <input id="searchInput" type="text" placeholder="Search" class="kt-input kt-input-sm" aria-label="Search text" />
                                  </div>
                                  <div class="flex gap-1">
                                    <button class="kt-btn kt-btn-sm kt-btn-outline" id="searchPrev" type="button">Prev</button>
                                    <button class="kt-btn kt-btn-sm kt-btn-outline" id="searchNext" type="button">Next</button>
                                  </div>
                                </div>
                              </div>
                              <div class="kt-menu-item" id="stampField" style="display: none">
                                <div class="kt-menu-link px-4 py-2" onclick="event.stopPropagation();">
                                  <div class="flex flex-col gap-2">
                                    <label class="kt-btn kt-btn-sm kt-btn-outline w-100" for="stamp-file">
                                      <i class="ki-filled ki-bookmark me-2"></i>
                                      Choose Stamp
                                    </label>
                                    <input id="stamp-file" type="file" accept="image/*" style="display: none" />
                                    <input id="stampUrl" type="text" placeholder="Paste image URL" class="kt-input kt-input-sm" />
                                    <button class="kt-btn kt-btn-sm kt-btn-outline" id="stampUseUrl" type="button">Use URL</button>
                                    <input id="stampSize" type="range" min="40" max="400" step="10" value="140" />
                                    <div class="flex gap-1">
                                      <button class="kt-btn kt-btn-sm kt-btn-outline" id="stampTL" type="button">TL</button>
                                      <button class="kt-btn kt-btn-sm kt-btn-outline" id="stampTR" type="button">TR</button>
                                      <button class="kt-btn kt-btn-sm kt-btn-outline" id="stampBR" type="button">BR</button>
                                      <button class="kt-btn kt-btn-sm kt-btn-outline" id="stampBL" type="button">BL</button>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="kt-scrollable-auto h-full max-h-[100vh] p-5" id="stage">
                      <div class="doc" id="doc"></div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div id="transcript-card-splitter" class="splitter-bar w-full h-1.5 relative cursor-row-resize flex items-center justify-center gap-2.5 py-0.5 group" data-splitter-bar="true">
              <span class="w-1 h-1 rounded-full bg-gray-500 opacity-0 group-hover:opacity-100 transition-opacity"></span>
              <span class="w-1 h-1 rounded-full bg-gray-500 opacity-0 group-hover:opacity-100 transition-opacity"></span>
              <span class="w-1 h-1 rounded-full bg-gray-500 opacity-0 group-hover:opacity-100 transition-opacity"></span>
            </div>
            <div id="transcript-card" class="card bg-background rounded-lg relative kt-scrollable-y-auto min-h-[200px] h-[200px]" data-splitter-pane="bottom">
              <div>
                <a href="javascript:;" class="kt-alert-close absolute right-0 top-0 z-1 mt-5 mr-5" data-kt-dismiss="alert" data-kt-target="#transcript-card">
                  <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g opacity="0.7">
                      <path
                        d="M11.6449 2.04935C12.1134 1.58082 12.1134 0.819928 11.6449 0.351398C11.1763 -0.117133 10.4154 -0.117133 9.9469 0.351398L6 4.30205L2.04935 0.355146C1.58082 -0.113384 0.819928 -0.113384 0.351398 0.355146C-0.117133 0.823676 -0.117133 1.58457 0.351398 2.0531L4.30205 6L0.355146 9.95065C-0.113384 10.4192 -0.113384 11.1801 0.355146 11.6486C0.823676 12.1171 1.58457 12.1171 2.0531 11.6486L6 7.69795L9.95065 11.6449C10.4192 12.1134 11.1801 12.1134 11.6486 11.6449C12.1171 11.1763 12.1171 10.4154 11.6486 9.9469L7.69795 6L11.6449 2.04935Z"
                        fill="currentColor"
                      />
                    </g>
                  </svg>
                </a>
              </div>
              <div class="card-body p-3">
                <div class="flex flex-col gap-2.5">
                  <div class="flex items-center grow gap-2.5">
                    <img alt="" class="rounded-full size-10 shrink-0" src="assets/media/avatars/blank.png" />
                    <div class="flex flex-col">
                      <span class="text-2sm text-secondary-foreground opacity-80">Justin Nash</span>
                      <span class="text-base text-xs">Ms. Lewis, did you personally observe any anomalies within the Riverside Project's submitted budgets?</span>
                    </div>
                  </div>
                  <div class="flex items-center grow gap-2.5">
                    <img alt="" class="rounded-full size-10 shrink-0" src="assets/media/avatars/blank.png" />
                    <div class="flex flex-col">
                      <span class="text-2sm text-secondary-foreground opacity-80">Stacey Lewis</span>
                      <span class="text-base text-xs">I did. The Q3 figures included significant discrepanciesroughly $128,000 in unverified vendor charges, which didn't align with internal procurement records.</span>
                    </div>
                  </div>
                  <div class="flex items-center grow gap-2.5">
                    <img alt="" class="rounded-full size-10 shrink-0" src="assets/media/avatars/blank.png" />
                    <div class="flex flex-col">
                      <span class="text-2sm text-secondary-foreground opacity-80">Brittany</span>
                      <span class="text-base text-xs">Can you clarify what led you to believe the charges were fraudulent?</span>
                    </div>
                  </div>
                  <div class="flex items-center grow gap-2.5">
                    <img alt="" class="rounded-full size-10 shrink-0" src="assets/media/avatars/blank.png" />
                    <div class="flex flex-col">
                      <span class="text-2sm text-secondary-foreground opacity-80">Justin Nash</span>
                      <span class="text-base text-xs">Ms. Lewis, did you personally observe any anomalies within the Riverside Project's submitted budgets?</span>
                    </div>
                  </div>
                  <div class="flex items-center grow gap-2.5">
                    <img alt="" class="rounded-full size-10 shrink-0" src="assets/media/avatars/blank.png" />
                    <div class="flex flex-col">
                      <span class="text-2sm text-secondary-foreground opacity-80">Stacey Lewis</span>
                      <span class="text-base text-xs">I did. The Q3 figures included significant discrepanciesroughly $128,000 in unverified vendor charges, which didn't align with internal procurement records.</span>
                    </div>
                  </div>
                  <div class="flex items-center grow gap-2.5">
                    <img alt="" class="rounded-full size-10 shrink-0" src="assets/media/avatars/blank.png" />
                    <div class="flex flex-col">
                      <span class="text-2sm text-secondary-foreground opacity-80">Brittany</span>
                      <span class="text-base text-xs">Can you clarify what led you to believe the charges were fraudulent?</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div id="kt_splitter_middle_right_bar" class="splitter-bar w-1.5 h-full relative cursor-col-resize flex items-center justify-center gap-2.5 px-0.5 group" data-splitter-bar="true">
            <span class="h-1 w-1 rounded-full bg-gray-500 opacity-0 group-hover:opacity-100 transition-opacity"></span>
            <span class="h-1 w-1 rounded-full bg-gray-500 opacity-0 group-hover:opacity-100 transition-opacity"></span>
            <span class="h-1 w-1 rounded-full bg-gray-500 opacity-0 group-hover:opacity-100 transition-opacity"></span>
          </div>
          <aside id="kt_splitter_main_right" class="kt_aside_right splitter-pane w-[180px] min-w-[180px] max-w-[400px] h-full shadow-sm transition-all duration-400 top-0 right-0 fixed shadow-none bg-background" data-splitter-pane="right">
            <div id="kt_splitter_right_verticle" class="splitter h-full flex flex-col">
              <div class="splitter-pane h-full bg-background rounded-lg overflow-hidden transition-all duration-400 flex flex-col" data-splitter-pane="top">
                <div class="px-2.5 py-2.5 pb-0 flex items-center justify-between">
                  <button id="kt_aside_toggle_right_mobile" class="kt-btn kt-btn-outline kt-btn-icon size-[30px] h-[36px] xl:hidden absolute -left-[28px] top-4" data-kt-toggle="true" data-kt-toggle-state="active" data-kt-toggle-target="body" data-kt-toggle-name="aside-minimize-right">
                    <i class="ki-duotone ki-double-right fs-3 transition-transform duration-300">
                      <span class="path1"></span>
                      <span class="path2"></span>
                    </i>
                  </button>
                  <div class="flex gap-1.5">
                    <div class="kt-menu" data-kt-menu="true">
                      <div class="kt-menu-item" data-kt-menu-item-offset="0, 0" data-kt-menu-item-placement="bottom-start" data-kt-menu-item-toggle="dropdown" data-kt-menu-item-trigger="click">
                        <button class="kt-btn kt-btn-outline kt-btn-primary kt-btn-sm rounded-sm line-height-1 kt-menu-toggle kt-btn kt-btn-sm kt-btn-icon dark:bg-white dark:text-dark">
                          <i class="ki-duotone ki-filter fs-4"></i>
                        </button>
                        <div class="kt-menu-dropdown kt-menu-default w-full max-w-[200px]" data-kt-menu-dismiss="true">
                          <div class="kt-menu-item">
                            <a class="kt-menu-link participant-status" data-status="all" href="#">
                              <span class="kt-menu-icon">
                                <i class="ki-duotone ki-people fs-5"></i>
                              </span>
                              <span class="kt-menu-link-hover:text-primary kt-menu-title">All Participants</span>
                            </a>
                          </div>
                          <div class="kt-menu-item">
                            <a class="kt-menu-link participant-status" data-status="admitted" href="#">
                              <span class="kt-menu-icon">
                                <i class="ki-duotone ki-check-circle fs-5 text-success"></i>
                              </span>
                              <span class="kt-menu-link-hover:text-primary kt-menu-title">Admitted</span>
                            </a>
                          </div>
                          <div class="kt-menu-item">
                            <a class="kt-menu-link participant-status" data-status="waiting" href="#">
                              <span class="kt-menu-icon">
                                <i class="ki-duotone ki-time fs-5"></i>
                              </span>
                              <span class="kt-menu-link-hover:text-primary kt-menu-title">waiting</span>
                            </a>
                          </div>
                          <div class="kt-menu-separator"></div>
                          <div class="kt-menu-item">
                            <a class="kt-menu-link participant-status" data-status="inactive" href="#">
                              <span class="kt-menu-icon">
                                <i class="ki-duotone ki-lock fs-5 text-muted"></i>
                              </span>
                              <span class="kt-menu-link-hover:text-primary kt-menu-title">Inactive</span>
                            </a>
                          </div>
                        </div>
                      </div>
                    </div>
                    <button class="kt-btn kt-btn-outline kt-btn-primary kt-btn-sm rounded-sm line-height-1 px-1.5 dark:bg-white dark:text-dark" data-kt-modal-toggle="#add_participate_modal">
                      <svg width="13" height="11" viewBox="0 0 13 11" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path
                          d="M4.55 0.975C4.98098 0.975 5.3943 1.1462 5.69905 1.45095C6.0038 1.7557 6.175 2.16902 6.175 2.6C6.175 3.03098 6.0038 3.4443 5.69905 3.74905C5.3943 4.0538 4.98098 4.225 4.55 4.225C4.11902 4.225 3.7057 4.0538 3.40095 3.74905C3.0962 3.4443 2.925 3.03098 2.925 2.6C2.925 2.16902 3.0962 1.7557 3.40095 1.45095C3.7057 1.1462 4.11902 0.975 4.55 0.975ZM4.55 5.2C5.23956 5.2 5.90088 4.92607 6.38848 4.43848C6.87607 3.95088 7.15 3.28956 7.15 2.6C7.15 1.91044 6.87607 1.24912 6.38848 0.761522C5.90088 0.273928 5.23956 0 4.55 0C3.86044 0 3.19912 0.273928 2.71152 0.761522C2.22393 1.24912 1.95 1.91044 1.95 2.6C1.95 3.28956 2.22393 3.95088 2.71152 4.43848C3.19912 4.92607 3.86044 5.2 4.55 5.2ZM3.62172 7.15H5.47828C6.81281 7.15 7.91781 8.13922 8.09859 9.425H1.00141C1.18219 8.13922 2.28719 7.15 3.62172 7.15ZM3.62172 6.175C1.62094 6.175 0 7.79594 0 9.79672C0 10.1298 0.270156 10.4 0.603281 10.4H8.49672C8.82984 10.4 9.1 10.1298 9.1 9.79672C9.1 7.79594 7.47906 6.175 5.47828 6.175H3.62172ZM10.2375 6.3375C10.2375 6.60766 10.4548 6.825 10.725 6.825C10.9952 6.825 11.2125 6.60766 11.2125 6.3375V5.0375H12.5125C12.7827 5.0375 13 4.82016 13 4.55C13 4.27984 12.7827 4.0625 12.5125 4.0625H11.2125V2.7625C11.2125 2.49234 10.9952 2.275 10.725 2.275C10.4548 2.275 10.2375 2.49234 10.2375 2.7625V4.0625H8.9375C8.66734 4.0625 8.45 4.27984 8.45 4.55C8.45 4.82016 8.66734 5.0375 8.9375 5.0375H10.2375V6.3375Z"
                          fill="currentColor"
                        />
                      </svg>
                      <!-- Add -->
                    </button>
                  </div>
                  <div class="flex gap-3">
                    <a href="#">
                      <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <g opacity="0.2">
                          <rect y="14" width="16" height="2" rx="1" fill="currentColor" />
                        </g>
                      </svg>
                    </a>
                    <a href="#">
                      <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <g opacity="0.2">
                          <rect y="7" width="16" height="9" rx="1" fill="currentColor" />
                        </g>
                      </svg>
                    </a>
                    <a href="#">
                      <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M15 9C15.5523 9 16 9.44772 16 10V15C16 15.5523 15.5523 16 15 16H1C0.447715 16 2.41598e-08 15.5523 0 15V10C0 9.44771 0.447715 9 1 9H15ZM15 0C15.5523 0 16 0.447715 16 1V6C16 6.55228 15.5523 7 15 7H1C0.447715 7 2.41598e-08 6.55228 0 6V1C0 0.447715 0.447715 0 1 0H15Z" fill="currentColor" />
                      </svg>
                    </a>
                  </div>
                </div>
                <div class="flex-1 px-2.5 py-2.5 kt-scrollable-y-auto flex flex-col gap-2 min-w-[180px] bg-background">
                  <div class="relative w-full bg-gray-200 rounded-md participant-card" data-status="admitted">
                    <div class="relative flex items-center justify-center shrink-0 rounded-md font-semibold leading-none text-xl size-10 text-mono bg-gray-400 dark:bg-light w-full min-h-[100px] h-auto">AS</div>
                    <div class="absolute top-1 left-1">
                      <div class="absolute -top-1 -right-1 my-0.5">
                        <span class="kt-avatar-status kt-avatar-status-online border-0"></span>
                      </div>
                      <span class="status-badge kt-badge kt-badge-sm kt-badge-light flex w-[20px]"></span>
                    </div>
                    <div class="kt-menu absolute top-1 right-1" data-kt-menu="true">
                      <div class="kt-menu-item kt-menu-item-dropdown" data-kt-menu-item-offset="0, 0" data-kt-menu-item-placement="bottom-end" data-kt-menu-item-placement-rtl="bottom-start" data-kt-menu-item-toggle="dropdown" data-kt-menu-item-trigger="click">
                        <button class="kt-menu-toggle kt-btn kt-btn-sm kt-btn-icon kt-btn-ghost w-[20px] h-auto py-0.5 rounded-[4px] bg-mono dark:bg-dark">
                          <i class="ki-filled ki-dots-vertical text-sm text-white"></i>
                        </button>
                        <div class="kt-menu-dropdown kt-menu-default w-full max-w-[175px] -mt-1 border-1 shadow-drop bg-background dark:bg-muted" data-kt-menu-dismiss="true">
                          <div class="kt-menu-item">
                            <a class="kt-menu-link px-4" href="#">
                              <span class="kt-menu-title">Add</span>
                            </a>
                            <a class="kt-menu-link px-4" href="#">
                              <span class="kt-menu-title">Remove</span>
                            </a>
                          </div>
                        </div>
                      </div>
                    </div>
                    <!-- <img src="https://dummyimage.com/350x250/ccc/000" alt="" class="rounded-md" /> -->
                    <div class="absolute bottom-1 left-1">
                      <span class="kt-badge kt-badge-mono kt-badge-sm dark:bg-dark dark:text-white">David Hall</span>
                    </div>
                    <div class="absolute bottom-1 right-1">
                      <span class="kt-badge kt-badge-success kt-badge-sm font-normal">Host</span>
                    </div>
                  </div>
                  <div class="relative w-full bg-gray-200 rounded-md participant-card" data-status="admitted">
                    <div class="relative flex items-center justify-center shrink-0 rounded-md font-semibold leading-none text-xl size-10 text-mono bg-gray-400 dark:bg-light w-full min-h-[100px] h-auto">DS</div>
                    <div class="absolute top-1 left-1">
                      <div class="absolute -top-1 -right-1 my-0.5">
                        <span class="kt-avatar-status kt-avatar-status-online border-0"></span>
                      </div>
                      <span class="status-badge kt-badge kt-badge-sm kt-badge-light flex w-[20px]"></span>
                    </div>
                    <div class="kt-menu absolute top-1 right-1" data-kt-menu="true">
                      <div class="kt-menu-item kt-menu-item-dropdown" data-kt-menu-item-offset="0, 0" data-kt-menu-item-placement="bottom-end" data-kt-menu-item-placement-rtl="bottom-start" data-kt-menu-item-toggle="dropdown" data-kt-menu-item-trigger="click">
                        <button class="kt-menu-toggle kt-btn kt-btn-sm kt-btn-icon kt-btn-ghost w-[20px] h-auto py-0.5 rounded-[4px] bg-mono dark:bg-dark">
                          <i class="ki-filled ki-dots-vertical text-sm text-white"></i>
                        </button>
                        <div class="kt-menu-dropdown kt-menu-default w-full max-w-[175px] -mt-1 border-1 shadow-drop bg-background dark:bg-muted" data-kt-menu-dismiss="true">
                          <div class="kt-menu-item">
                            <a class="kt-menu-link px-4" href="#">
                              <span class="kt-menu-title">Add</span>
                            </a>
                            <a class="kt-menu-link px-4" href="#">
                              <span class="kt-menu-title">Remove</span>
                            </a>
                          </div>
                        </div>
                      </div>
                    </div>
                    <!-- <img src="https://dummyimage.com/350x250/ccc/000" alt="" class="rounded-md" /> -->
                    <div class="absolute bottom-1 left-1">
                      <span class="kt-badge kt-badge-mono kt-badge-sm dark:bg-dark dark:text-white">Stacey Lewis</span>
                    </div>
                    <div class="absolute bottom-1 right-1">
                      <span class="kt-badge kt-badge-success kt-badge-sm font-normal">Witness</span>
                    </div>
                  </div>
                  <div class="relative w-full bg-gray-200 rounded-md participant-card" data-status="waiting">
                    <div class="relative flex items-center justify-center shrink-0 rounded-md font-semibold leading-none text-xl size-10 text-mono bg-gray-400 dark:bg-light w-full min-h-[100px] h-auto">VR</div>
                    <div class="absolute top-1 left-1">
                      <div class="absolute -top-1 -right-1 my-0.5">
                        <span class="kt-avatar-status kt-avatar-status-offline border-0"></span>
                      </div>
                      <span class="status-badge kt-badge kt-badge-sm kt-badge-light flex w-[20px]"></span>
                    </div>
                    <div class="kt-menu absolute top-1 right-1" data-kt-menu="true">
                      <div class="kt-menu-item kt-menu-item-dropdown" data-kt-menu-item-offset="0, 0" data-kt-menu-item-placement="bottom-end" data-kt-menu-item-placement-rtl="bottom-start" data-kt-menu-item-toggle="dropdown" data-kt-menu-item-trigger="click">
                        <button class="kt-menu-toggle kt-btn kt-btn-sm kt-btn-icon kt-btn-ghost w-[20px] h-auto py-0.5 rounded-[4px] bg-mono dark:bg-dark">
                          <i class="ki-filled ki-dots-vertical text-sm text-white"></i>
                        </button>
                        <div class="kt-menu-dropdown kt-menu-default w-full max-w-[175px] -mt-1 border-1 shadow-drop bg-background dark:bg-muted" data-kt-menu-dismiss="true">
                          <div class="kt-menu-item">
                            <a class="kt-menu-link px-4" href="#">
                              <span class="kt-menu-title">Add</span>
                            </a>
                            <a class="kt-menu-link px-4" href="#">
                              <span class="kt-menu-title">Remove</span>
                            </a>
                          </div>
                        </div>
                      </div>
                    </div>
                    <!-- <img src="https://dummyimage.com/350x250/ccc/000" alt="" class="rounded-md" /> -->
                    <div class="absolute bottom-1 left-1">
                      <span class="kt-badge kt-badge-mono kt-badge-sm dark:bg-dark dark:text-white">Bradford Bur...</span>
                    </div>
                  </div>
                  <div class="relative w-full bg-gray-200 rounded-md participant-card" data-status="inactive">
                    <div class="relative flex items-center justify-center shrink-0 rounded-md font-semibold leading-none text-xl size-10 text-mono bg-gray-400 dark:bg-light w-full min-h-[100px] h-auto">TG</div>
                    <div class="absolute top-1 left-1">
                      <div class="absolute -top-1 -right-1 my-0.5">
                        <span class="kt-avatar-status kt-avatar-status-offline border-0"></span>
                      </div>
                      <span class="status-badge kt-badge kt-badge-sm kt-badge-light flex w-[20px]"></span>
                    </div>
                    <div class="kt-menu absolute top-1 right-1" data-kt-menu="true">
                      <div class="kt-menu-item kt-menu-item-dropdown" data-kt-menu-item-offset="0, 0" data-kt-menu-item-placement="bottom-end" data-kt-menu-item-placement-rtl="bottom-start" data-kt-menu-item-toggle="dropdown" data-kt-menu-item-trigger="click">
                        <button class="kt-menu-toggle kt-btn kt-btn-sm kt-btn-icon kt-btn-ghost w-[20px] h-auto py-0.5 rounded-[4px] bg-mono dark:bg-dark">
                          <i class="ki-filled ki-dots-vertical text-sm text-white"></i>
                        </button>
                        <div class="kt-menu-dropdown kt-menu-default w-full max-w-[175px] -mt-1 border-1 shadow-drop bg-background dark:bg-muted" data-kt-menu-dismiss="true">
                          <div class="kt-menu-item">
                            <a class="kt-menu-link px-4" href="#">
                              <span class="kt-menu-title">Add</span>
                            </a>
                            <a class="kt-menu-link px-4" href="#">
                              <span class="kt-menu-title">Remove</span>
                            </a>
                          </div>
                        </div>
                      </div>
                    </div>
                    <!-- <img src="https://dummyimage.com/350x250/ccc/000" alt="" class="rounded-md" /> -->
                    <div class="absolute bottom-1 left-1">
                      <span class="kt-badge kt-badge-mono kt-badge-sm dark:bg-dark dark:text-white">Justin Nash</span>
                    </div>
                  </div>
                  <div class="relative w-full bg-gray-200 rounded-md participant-card" data-status="waiting">
                    <div class="relative flex items-center justify-center shrink-0 rounded-md font-semibold leading-none text-xl size-10 text-mono bg-gray-400 dark:bg-light w-full min-h-[100px] h-auto">OS</div>
                    <div class="absolute top-1 left-1">
                      <div class="absolute -top-1 -right-1 my-0.5">
                        <span class="kt-avatar-status kt-avatar-status-offline border-0"></span>
                      </div>
                      <span class="status-badge kt-badge kt-badge-sm kt-badge-light flex w-[20px]"></span>
                    </div>
                    <div class="kt-menu absolute top-1 right-1" data-kt-menu="true">
                      <div class="kt-menu-item kt-menu-item-dropdown" data-kt-menu-item-offset="0, 0" data-kt-menu-item-placement="bottom-end" data-kt-menu-item-placement-rtl="bottom-start" data-kt-menu-item-toggle="dropdown" data-kt-menu-item-trigger="click">
                        <button class="kt-menu-toggle kt-btn kt-btn-sm kt-btn-icon kt-btn-ghost w-[20px] h-auto py-0.5 rounded-[4px] bg-mono dark:bg-dark">
                          <i class="ki-filled ki-dots-vertical text-sm text-white"></i>
                        </button>
                        <div class="kt-menu-dropdown kt-menu-default w-full max-w-[175px] -mt-1 border-1 shadow-drop bg-background dark:bg-muted" data-kt-menu-dismiss="true">
                          <div class="kt-menu-item">
                            <a class="kt-menu-link px-4" href="#">
                              <span class="kt-menu-title">Add</span>
                            </a>
                            <a class="kt-menu-link px-4" href="#">
                              <span class="kt-menu-title">Remove</span>
                            </a>
                          </div>
                        </div>
                      </div>
                    </div>
                    <!-- <img src="https://dummyimage.com/350x250/ccc/000" alt="" class="rounded-md" /> -->
                    <div class="absolute bottom-1 left-1">
                      <span class="kt-badge kt-badge-mono kt-badge-sm dark:bg-dark dark:text-white">Bradford Bur...</span>
                    </div>
                  </div>
                  <div class="relative w-full bg-gray-200 rounded-md participant-card" data-status="inactive">
                    <div class="relative flex items-center justify-center shrink-0 rounded-md font-semibold leading-none text-xl size-10 text-mono bg-gray-400 dark:bg-light w-full min-h-[100px] h-auto">AM</div>
                    <div class="absolute top-1 left-1">
                      <div class="absolute -top-1 -right-1 my-0.5">
                        <span class="kt-avatar-status kt-avatar-status-offline border-0"></span>
                      </div>
                      <span class="status-badge kt-badge kt-badge-sm kt-badge-light flex w-[20px]"></span>
                    </div>
                    <!-- <img src="https://dummyimage.com/350x250/ccc/000" alt="" class="rounded-md" /> -->
                    <div class="absolute bottom-1 left-1">
                      <span class="kt-badge kt-badge-mono kt-badge-sm dark:bg-dark dark:text-white">Justin Nash</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </aside>
        </div>
      </main>
    </div>

    <div class="kt-modal" data-kt-modal="true" id="upload_document_modal">
      <div class="kt-modal-content max-w-[500px] top-5 lg:top-[15%]">
        <div class="kt-modal-header">
          <h3 class="kt-modal-title text-xl">Upload New Document(s)</h3>
          <button class="kt-btn kt-btn-sm kt-btn-icon kt-btn-ghost shrink-0" data-kt-modal-dismiss="true">
            <i class="ki-filled ki-cross"> </i>
          </button>
        </div>
        <div class="kt-modal-body grid gap-5 px-5 py-5">
          <form class="kt-form">
            <div class="kt-form-item mb-3">
              <div class="border-2 border-dashed border-gray-200 rounded-lg px-5 py-5 flex items-center gap-4 relative">
                <input type="file" id="file_upload" class="kt-input" multiple accept=".pdf,.xls,.xlsx,.doc,.docx,.ppt,.pptx,.txt,.html,.jpg,.jpeg,.png,.gif,.bmp,.tiff" style="position: absolute; opacity: 0; width: 0; height: 0" />
                <button type="button" class="kt-btn kt-btn-primary shrink-0" onclick="document.getElementById('file_upload').click()">Attach files</button>
                <span class="text-primary font-medium">Or drop files here</span>
              </div>
            </div>
            <div class="kt-form-item">
              <p class="text-sm text-gray-500">Upload a pdf, xls, doc, ppt, txt, html, or image file (jpg, png, gif, bmp, tiff), 1GB Maximum. You can upload multiple files by clicking on Browse button or drag & drop from your file system.</p>
            </div>
            <div class="kt-form-actions">
              <button type="button" class="kt-btn kt-btn-outline" data-kt-modal-dismiss="true">Cancel</button>
              <button type="submit" class="kt-btn kt-btn-primary">Upload</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <div class="kt-modal" data-kt-modal="true" id="add_participate_modal">
      <div class="kt-modal-content max-w-[500px] top-5 lg:top-[15%]">
        <div class="kt-modal-header">
          <h3 class="kt-modal-title text-xl">Invite Participant</h3>
          <button class="kt-btn kt-btn-sm kt-btn-icon kt-btn-ghost shrink-0" data-kt-modal-dismiss="true">
            <i class="ki-filled ki-cross"> </i>
          </button>
        </div>
        <div class="kt-modal-body grid gap-5 px-5 py-5">
          <form class="kt-form">
            <div class="kt-form-item">
              <label class="kt-form-label text-base">First Name</label>
              <div class="kt-form-control">
                <input type="text" class="kt-input kt-input-lg" placeholder="First Name" />
              </div>
            </div>
            <div class="kt-form-item">
              <label class="kt-form-label text-base">Last Name</label>
              <div class="kt-form-control">
                <input type="text" class="kt-input kt-input-lg" placeholder="Last Name" />
              </div>
            </div>
            <div class="kt-form-item">
              <label class="kt-form-label text-base">Email Address</label>
              <div class="kt-form-control">
                <input type="text" class="kt-input kt-input-lg" placeholder="Email Address" />
              </div>
            </div>
            <div class="kt-form-item">
              <label class="kt-form-label text-base">Role</label>
              <div class="kt-form-control">
                <select class="kt-select kt-select-lg" data-kt-select="true">
                  <option selected="">Select Role</option>
                  <option>Owner</option>
                  <option>Editor</option>
                  <option>Viewer</option>
                </select>
              </div>
            </div>
            <div class="kt-form-item">
              <div class="flex items-center gap-2">
                <input type="checkbox" class="kt-checkbox kt-checkbox-lg" id="check" value="1" />
                <label class="kt-label text-base" for="check">Allow document upload</label>
              </div>
            </div>
            <div class="kt-form-item"></div>
            <div class="kt-form-actions">
              <button type="button" class="kt-btn kt-btn-outline">Save & Close</button>
              <button type="submit" class="kt-btn">Invite Existing User</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Device Setting Modal -->
    <div class="kt-modal" data-kt-modal="true" id="device_setting_modal">
      <div class="kt-modal-content max-w-[800px] top-5 lg:top-[15%]">
        <div class="kt-modal-header">
          <h3 class="kt-modal-title text-xl">Device Settings</h3>
          <button class="kt-btn kt-btn-sm kt-btn-icon kt-btn-ghost shrink-0" data-kt-modal-dismiss="true">
            <i class="ki-filled ki-cross"></i>
          </button>
        </div>
        <div class="kt-modal-body p-0">
          <div class="flex">
            <div class="w-[200px] border-r border-border bg-background py-4">
              <div class="kt-tabs kt-tabs-line flex-col items-start border-0 gap-2" data-kt-tabs="true">
                <button class="kt-tab-toggle active w-full border-0 kt-tab-active:bg-primary/10 rounded px-4.5 py-2" data-kt-tab-toggle="#tab_video">
                  <svg class="w-5 h-auto" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path
                      d="M16 10L18.5768 8.45392C19.3699 7.97803 19.7665 7.74009 20.0928 7.77051C20.3773 7.79703 20.6369 7.944 20.806 8.17433C21 8.43848 21 8.90095 21 9.8259V14.1741C21 15.099 21 15.5615 20.806 15.8257C20.6369 16.056 20.3773 16.203 20.0928 16.2295C19.7665 16.2599 19.3699 16.022 18.5768 15.5461L16 14M6.2 18H12.8C13.9201 18 14.4802 18 14.908 17.782C15.2843 17.5903 15.5903 17.2843 15.782 16.908C16 16.4802 16 15.9201 16 14.8V9.2C16 8.0799 16 7.51984 15.782 7.09202C15.5903 6.71569 15.2843 6.40973 14.908 6.21799C14.4802 6 13.9201 6 12.8 6H6.2C5.0799 6 4.51984 6 4.09202 6.21799C3.71569 6.40973 3.40973 6.71569 3.21799 7.09202C3 7.51984 3 8.07989 3 9.2V14.8C3 15.9201 3 16.4802 3.21799 16.908C3.40973 17.2843 3.71569 17.5903 4.09202 17.782C4.51984 18 5.07989 18 6.2 18Z"
                      stroke="currentColor"
                      stroke-width="1"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                  </svg>
                  Video
                </button>
                <button class="kt-tab-toggle border-0 w-full kt-tab-active:bg-primary/10 rounded px-4.5 py-2" data-kt-tab-toggle="#tab_audio">
                  <svg class="w-5 h-5" width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="4.36" y="1.5" width="15.27" height="21" />
                    <circle cx="12" cy="6.27" r="1.91"></circle>
                    <circle cx="12" cy="15.82" r="3.82"></circle>
                    <circle cx="12" cy="15.82" r="0.95" fill="currentColor" stroke="none"></circle>
                  </svg>
                  Audio
                </button>
              </div>
            </div>
            <div class="flex-1 p-6">
              <div class="text-sm">
                <div class="p-7" id="tab_video">
                  <div>
                    <span class="text-primary text-sm font-semibold cursor-pointer hover:text-primary -mt-0.5 line-height-1 grid"> Microphone </span>
                    <div class="pt-2">
                      <select
                        class="kt-select"
                        data-kt-select="true"
                        data-kt-select-placeholder="Select a framework"
                        data-kt-select-config='{
                        "optionsClass": "kt-scrollable overflow-auto max-h-[250px]"
                      }'
                      >
                        <option value="react">
                          Microphone (Realtek High Definition Audio) <br />
                          System default
                        </option>
                      </select>
                    </div>
                  </div>
                  <div>
                    <label for="">
                      <h6>Push to talk</h6>
                      <div>
                        <p>Press and hold spacebar to unmute your mic</p>
                      </div>
                    </label>
                  </div>
                </div>
                <div class="hidden" id="tab_audio">
                  <!-- Audio content. -->
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <script src="assets/js/core.bundle.js"></script>
    <script src="assets/vendors/ktui/ktui.min.js"></script>
    <script src="assets/vendors/apexcharts/apexcharts.min.js"></script>
    <script src="assets/js/widgets/general.js"></script>
    <script src="assets/js/splitter.js"></script>
    <script src="assets/js/layouts/demo1.js"></script>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const closeBtn = document.querySelector('[data-kt-target="#transcript-card"]');
        const captionBtn = document.getElementById("caption-btn");
        const transcriptCard = document.getElementById("transcript-card");
        const transcriptCardSplitter = document.getElementById("transcript-card-splitter");

        if (closeBtn && transcriptCard) {
          closeBtn.addEventListener("click", function (e) {
            e.preventDefault();
            transcriptCard.style.transition = "opacity 0.3s ease-out, height 0.3s ease-out";
            transcriptCard.style.opacity = "0";
            transcriptCard.style.overflow = "hidden";

            if (transcriptCardSplitter) {
              transcriptCardSplitter.style.transition = "opacity 0.3s ease-out";
              transcriptCardSplitter.style.opacity = "0";
            }

            setTimeout(function () {
              transcriptCard.style.display = "none";
              if (transcriptCardSplitter) {
                transcriptCardSplitter.style.display = "none";
              }
            }, 300);
          });
        }

        if (captionBtn && transcriptCard) {
          captionBtn.addEventListener("click", function (e) {
            e.preventDefault();
            if (transcriptCard.style.display === "none" || transcriptCard.style.display === "") {
              transcriptCard.style.display = "";
              transcriptCard.style.opacity = "0";
              transcriptCard.style.transition = "opacity 0.3s ease-out";
              transcriptCard.style.overflow = "";
              transcriptCard.style.height = "";
              // transcriptCard.style.flexShrink = "";

              if (transcriptCardSplitter) {
                transcriptCardSplitter.style.display = "";
                transcriptCardSplitter.style.opacity = "0";
                transcriptCardSplitter.style.transition = "opacity 0.3s ease-out";
              }

              setTimeout(function () {
                transcriptCard.style.opacity = "1";
                if (transcriptCardSplitter) {
                  transcriptCardSplitter.style.opacity = "1";
                }
              }, 10);
            }
          });
        }

        KTSplitter.createInstance("#kt_splitter_main", {
          min: 200,
          max: 1200,
          orientation: "horizontal",
        });

        KTSplitter.createInstance("#kt_splitter_left_verticle", {
          min: 50,
          max: 600,
          orientation: "vertical",
        });

        KTSplitter.createInstance("#kt_splitter_right_verticle", {
          min: 150,
          max: 600,
          orientation: "vertical",
        });

        KTSplitter.createInstance("#kt_splitter_middle_vertical", {
          min: 200,
          max: 600,
          orientation: "vertical",
        });

        document.querySelectorAll(".participant-status").forEach((item) => {
          item.addEventListener("click", function (e) {
            e.preventDefault();

            const status = this.dataset.status;

            document.querySelectorAll(".participant-card").forEach((card) => {
              if (status === "all" || card.dataset.status === status) {
                card.style.display = "";
              } else {
                card.style.display = "none";
              }
            });
          });
        });

        document.querySelectorAll(".participant-card").forEach((card) => {
          const status = card.dataset.status.toLowerCase();
          const badge = card.querySelector(".status-badge");

          if (!badge) return;

          let badgeClass = "";
          let icon = "";

          switch (status) {
            case "admitted":
              badgeClass = "kt-badge-success";
              icon = "ki-check-circle";
              break;

            case "waiting":
              badgeClass = "kt-badge-warning";
              icon = "ki-time";
              break;

            case "inactive":
              badgeClass = "kt-badge-info";
              icon = "ki-lock";
              break;
          }

          badge.classList.add(badgeClass);
          badge.innerHTML = `<i class="ki-duotone ${icon} text-xs"></i>`;
        });

        const asideToggleLeft = document.getElementById("kt_aside_toggle_left");
        const asideToggleLeftMobile = document.getElementById("kt_aside_toggle_left_mobile");
        const asideLeft = document.querySelector(".kt_aside_left");
        const asideIconLeft = asideToggleLeft?.querySelector("i");
        const asideIconLeftMobile = asideToggleLeftMobile?.querySelector("i");
        const splitterBar = document.getElementById("kt_splitter_middle_left_bar");

        function handleAsideToggle(e) {
          if (e) e.preventDefault();

          const currentWidth = asideLeft.style.width;
          const computedWidth = window.getComputedStyle(asideLeft).width;
          const isCollapsed = currentWidth === "0px" || currentWidth === "0" || (currentWidth === "" && computedWidth === "0px");
          const originalWidth = "300px";

          asideLeft.style.transition = "width 400ms ease-in-out, min-width 400ms ease-in-out";

          if (isCollapsed) {
            asideLeft.style.overflow = "hidden";
            asideLeft.style.minWidth = "0";

            requestAnimationFrame(() => {
              asideLeft.style.width = originalWidth;
              asideLeft.style.minWidth = "300px";

              setTimeout(() => {
                asideLeft.style.overflow = "";
              }, 400);
            });

            if (asideIconLeft) {
              asideIconLeft.style.transform = "rotate(0deg)";
            }
            if (asideIconLeftMobile) {
              asideIconLeftMobile.style.transform = "rotate(0deg)";
            }
            if (splitterBar) {
              splitterBar.style.display = "";
            }
          } else {
            asideLeft.style.width = "0";
            asideLeft.style.minWidth = "0";
            asideLeft.style.overflow = "hidden";

            if (asideIconLeft) {
              asideIconLeft.style.transform = "rotate(180deg)";
            }
            if (asideIconLeftMobile) {
              asideIconLeftMobile.style.transform = "rotate(180deg)";
            }
            if (splitterBar) {
              splitterBar.style.display = "none";
            }
          }
        }

        if (asideToggleLeft && asideLeft) {
          asideToggleLeft.addEventListener("click", handleAsideToggle);
        }

        if (asideToggleLeftMobile && asideLeft) {
          asideToggleLeftMobile.addEventListener("click", handleAsideToggle);
        }

        const asideToggleRight = document.getElementById("kt_aside_toggle_right");
        const asideToggleRightMobile = document.getElementById("kt_aside_toggle_right_mobile");
        const asideRight = document.querySelector(".kt_aside_right");
        const asideIconRight = asideToggleRight?.querySelector("i");
        const asideIconRightMobile = asideToggleRightMobile?.querySelector("i");
        const splitterBarRight = document.getElementById("kt_splitter_middle_right_bar");

        function handleAsideToggleRight(e) {
          if (e) e.preventDefault();

          const isCollapsedRight = asideRight.style.width === "0px" || asideRight.style.width === "0";
          const originalWidthRight = "180px";

          if (isCollapsedRight) {
            asideRight.style.width = originalWidthRight;
            asideRight.style.minWidth = "180px";
            asideRight.style.overflow = "";
            if (asideIconRight) {
              asideIconRight.style.transform = "rotate(0deg)";
            }
            if (asideIconRightMobile) {
              asideIconRightMobile.style.transform = "rotate(0deg)";
            }
            if (splitterBarRight) {
              splitterBarRight.style.display = "";
            }
          } else {
            asideRight.style.width = "0";
            asideRight.style.minWidth = "0";
            asideRight.style.overflow = "hidden";
            if (asideIconRight) {
              asideIconRight.style.transform = "rotate(180deg)";
            }
            if (asideIconRightMobile) {
              asideIconRightMobile.style.transform = "rotate(180deg)";
            }
            if (splitterBarRight) {
              splitterBarRight.style.display = "none";
            }
          }
        }

        if (asideToggleRight && asideRight) {
          asideToggleRight.addEventListener("click", handleAsideToggleRight);
        }

        if (asideToggleRightMobile && asideRight) {
          asideToggleRightMobile.addEventListener("click", handleAsideToggleRight);
        }

        // Toggle h-half to h-auto on accordion click
        const accordionToggleSecondDoc = document.getElementById("accordion_toggle_second_doc");
        const secondDocumentsAccordion = document.getElementById("second_documents_accordion");
        const firstDocumentsAccordion = document.getElementById("first_documents_accordion");

        if (accordionToggleSecondDoc && secondDocumentsAccordion) {
          accordionToggleSecondDoc.addEventListener("click", function () {
            if (secondDocumentsAccordion.classList.contains("h-half")) {
              secondDocumentsAccordion.classList.remove("h-half");
              secondDocumentsAccordion.classList.add("h-auto");
            } else {
              secondDocumentsAccordion.classList.remove("h-auto");
              secondDocumentsAccordion.classList.add("h-half");
            }

            // Toggle first documents accordion h-half to h-full
            if (firstDocumentsAccordion) {
              if (firstDocumentsAccordion.classList.contains("h-half")) {
                firstDocumentsAccordion.classList.remove("h-half");
                firstDocumentsAccordion.classList.add("h-full");
              } else {
                firstDocumentsAccordion.classList.remove("h-full");
                firstDocumentsAccordion.classList.add("h-half");
              }
            }
          });
        }
      });
    </script>

    <script type="module">
      import * as pdfjsLib from "https://cdn.jsdelivr.net/npm/pdfjs-dist@4.6.82/build/pdf.min.mjs";
      pdfjsLib.GlobalWorkerOptions.workerSrc = "https://cdn.jsdelivr.net/npm/pdfjs-dist@4.6.82/build/pdf.worker.min.mjs";
      import { PDFDocument, StandardFonts, rgb } from "https://cdn.jsdelivr.net/npm/pdf-lib@1.17.1/+esm";

      /* ===== DOM ===== */
      const fileInput = document.getElementById("file");
      const exportBtn = document.getElementById("export");
      const downloadLogBtn = document.getElementById("downloadLog");
      const exportAnnotationsBtn = document.getElementById("exportAnnotations");
      const importJsonInput = document.getElementById("import-json");
      const btnSelect = document.getElementById("tool-select");
      const btnPen = document.getElementById("tool-pen");
      const btnHigh = document.getElementById("tool-high");
      const btnText = document.getElementById("tool-text");
      const penColorEl = document.getElementById("penColor");
      const penWidthEl = document.getElementById("penWidth");
      const highColorEl = document.getElementById("highColor");
      const textColorEl = document.getElementById("textColor");
      const imgInput = document.getElementById("img-file");
      const zoomOutBtn = document.getElementById("zoomOut");
      const zoomInBtn = document.getElementById("zoomIn");
      const zoomResetBtn = document.getElementById("zoomReset");
      const zoomLabel = document.getElementById("zoomLabel");
      const searchInput = document.getElementById("searchInput");
      const searchPrev = document.getElementById("searchPrev");
      const searchNext = document.getElementById("searchNext");
      const stage = document.getElementById("stage");
      const docEl = document.getElementById("doc");
      const stampFile = document.getElementById("stamp-file");
      const stampSizeEl = document.getElementById("stampSize");
      const btnTL = document.getElementById("stampTL");
      const btnTR = document.getElementById("stampTR");
      const btnBR = document.getElementById("stampBR");
      const btnBL = document.getElementById("stampBL");
      const stampUrl = document.getElementById("stampUrl");
      const stampUseUrl = document.getElementById("stampUseUrl");
      const penStack = document.getElementById("penStack");
      const highStack = document.getElementById("highStack");
      const textStack = document.getElementById("textStack");
      const toggleLockBtn = document.getElementById("toggleLock");

      /* ===== State ===== */
      let pdfDoc = null,
        originalPdfBytes = null;
      let baseScale = 1,
        zoom = 1;
      const DPR = Math.max(1, window.devicePixelRatio || 1);
      const MAX_CSS_WIDTH = 1100; // narrower cap
      const MIN_CSS_WIDTH = 720;
      let tool = "select",
        isDrawing = false,
        currPath = null;
      let penColor = "#111827",
        penWidth = 3,
        highColor = "#ffe600",
        textColor = "#111827";
      const pages = []; // {num, outer, wrap, viewportEl, canvas, svg, annLayer, hitsLayer, baseW, baseH, textItems}
      let selectedPath = null,
        selectedAnn = null;
      let dragTarget = null,
        dragOffset = { x: 0, y: 0 },
        resizeTarget = null,
        resizeStart = null;
      let imageArmed = false,
        pendingImageDataURL = null;
      let currentPage = 1,
        pendingPage = null;
      let currentName = "document.pdf";

      /* Search */
      let searchQuery = "",
        allHits = [],
        hitIndex = -1;

      /* Stamps */
      let stampDataURL = null;

      /* ===== Logging ===== */
      const eventLog = [];
      let autoExportOnEmit = false;

      function emit(name, detail) {
        eventLog.push({ time: Date.now(), event: name, ...detail });
        window.dispatchEvent(new CustomEvent(name, { detail }));

        // Auto-export single annotation when annotation events are emitted
        if (autoExportOnEmit && name.startsWith("annotation:") && detail && detail.id) {
          const annotation = findAnnotationById(detail.id);
          if (annotation) {
            // Add event information to the annotation
            const annotationWithEvent = {
              ...annotation,
              event: name,
              eventTimestamp: Date.now(),
            };

            const jsonStr = JSON.stringify(annotationWithEvent, null, 2);

            // Emit custom event with single annotation data
            window.dispatchEvent(
              new CustomEvent("annotations:exported", {
                detail: {
                  annotation: annotationWithEvent,
                  json: jsonStr,
                  timestamp: Date.now(),
                  triggeredBy: name,
                  annotationId: detail.id,
                },
              })
            );
          }
        }
      }

      // Find annotation by ID
      function findAnnotationById(id) {
        if (!id) return null;

        // Search in SVG paths (pen/highlighter)
        for (const p of pages) {
          const path = p.svg.querySelector(`path[data-id="${id}"]`);
          if (path) {
            return {
              id: path.getAttribute("data-id"),
              type: path.getAttribute("data-type"),
              page: p.num,
              points: path._points || [],
              color: path.getAttribute("stroke"),
              width: parseFloat(path.getAttribute("stroke-width")) || 3,
              locked: path.getAttribute("data-locked") === "true",
            };
          }
        }

        // Search in image and text annotations
        for (const p of pages) {
          const ann = p.annLayer.querySelector(`[data-anno-id="${id}"]`);
          if (ann) {
            if (ann.classList.contains("ann") && ann.dataset.type === "image") {
              const img = ann.querySelector("img");
              return {
                id: ann.dataset.annoId,
                type: "image",
                page: p.num,
                src: img ? img.src : "",
                rect: {
                  x: +ann.dataset.x,
                  y: +ann.dataset.y,
                  width: +ann.dataset.w,
                  height: +ann.dataset.h,
                },
                stamp: ann.dataset.stamp === "true",
                locked: ann.dataset.locked === "true",
              };
            } else if (ann.classList.contains("ann-text") && ann.dataset.type === "text") {
              const textDiv = ann.querySelector(".text");
              const style = textDiv ? getComputedStyle(textDiv) : {};
              return {
                id: ann.dataset.annoId,
                type: "text",
                page: p.num,
                text: textDiv ? textDiv.textContent : "",
                rect: {
                  x: +ann.dataset.x,
                  y: +ann.dataset.y,
                  width: +ann.dataset.w,
                  height: +ann.dataset.h,
                },
                color: style.color || textColor,
                fontSize: parseFloat(style.fontSize) || 18,
                locked: ann.dataset.locked === "true",
              };
            }
          }
        }

        return null;
      }

      // Export current annotations as JSON (with lock status)
      function exportAnnotationsJSON() {
        const annotations = [];

        // Export pen/highlighter strokes (SVG paths)
        for (const p of pages) {
          const paths = Array.from(p.svg.querySelectorAll("path[data-id]"));
          for (const path of paths) {
            const ann = {
              id: path.getAttribute("data-id"),
              type: path.getAttribute("data-type"),
              page: p.num,
              points: path._points || [],
              color: path.getAttribute("stroke"),
              width: parseFloat(path.getAttribute("stroke-width")) || 3,
              locked: path.getAttribute("data-locked") === "true",
            };
            annotations.push(ann);
          }
        }

        // Export image and text annotations
        for (const p of pages) {
          const imgs = Array.from(p.annLayer.querySelectorAll('.ann[data-type="image"]'));
          for (const el of imgs) {
            const img = el.querySelector("img");
            annotations.push({
              id: el.dataset.annoId,
              type: "image",
              page: p.num,
              src: img ? img.src : "",
              rect: getRectData(el),
              stamp: el.dataset.stamp === "true",
              locked: el.dataset.locked === "true",
            });
          }

          const texts = Array.from(p.annLayer.querySelectorAll('.ann-text[data-type="text"]'));
          for (const el of texts) {
            const textDiv = el.querySelector(".text");
            const style = textDiv ? getComputedStyle(textDiv) : {};
            annotations.push({
              id: el.dataset.annoId,
              type: "text",
              page: p.num,
              text: textDiv ? textDiv.textContent : "",
              rect: getRectData(el),
              color: style.color || textColor,
              fontSize: parseFloat(style.fontSize) || 18,
              locked: el.dataset.locked === "true",
            });
          }
        }

        return { annotations, exportedAt: Date.now() };
      }

      // Export annotations only
      // Export event log only
      downloadLogBtn.onclick = () => {
        const blob = new Blob([JSON.stringify(eventLog, null, 2)], { type: "application/json" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "event-log.json";
        document.body.appendChild(a);
        a.click();
        a.remove();
        URL.revokeObjectURL(url);
      };

      /* ===== Helpers ===== */
      const uid = () => Math.random().toString(36).slice(2) + Date.now().toString(36);
      const hexToRgb = (hex) => {
        let h = hex.replace("#", "");
        if (h.length === 3)
          h = h
            .split("")
            .map((c) => c + c)
            .join("");
        const n = parseInt(h, 16);
        return { r: (n >> 16) & 255, g: (n >> 8) & 255, b: n & 255 };
      };
      function setTool(t) {
        tool = t;
        // Update aria-pressed and active class for all tool buttons
        [btnSelect, btnPen, btnHigh, btnText].forEach(function (b) {
          if (b) {
            b.setAttribute("aria-pressed", "false");
            b.classList.remove("active");
          }
        });
        var map = { select: btnSelect, pen: btnPen, high: btnHigh, text: btnText };
        if (map[t] && map[t]) {
          map[t].setAttribute("aria-pressed", "true");
          map[t].classList.add("active");
        }
        // contextual controls toggle (no optional chaining for broad support)
        [penStack, highStack, textStack].forEach(function (s) {
          if (s) s.removeAttribute("data-active");
        });
        var stackMap = { pen: penStack, high: highStack, text: textStack };
        if (stackMap[t]) stackMap[t].setAttribute("data-active", "true");
      }
      btnSelect.onclick = function (e) {
        e.stopPropagation();
        setTool("select");
      };
      btnPen.onclick = function (e) {
        e.stopPropagation();
        setTool("pen");
      };
      btnHigh.onclick = function (e) {
        e.stopPropagation();
        setTool("high");
      };
      btnText.onclick = function (e) {
        e.stopPropagation();
        setTool("text");
      };

      // Reinitialize KTMenu for new dropdowns after DOM is ready
      if (typeof KTMenu !== "undefined" && KTMenu.init) {
        setTimeout(function () {
          try {
            KTMenu.init();
          } catch (e) {
            console.warn("KTMenu reinit:", e);
          }
        }, 100);
      }

      penColorEl.oninput = () => (penColor = penColorEl.value);
      penWidthEl.oninput = () => {
        penWidth = +penWidthEl.value;
        const penWidthValueEl = document.getElementById("penWidthValue");
        if (penWidthValueEl) penWidthValueEl.textContent = penWidth + "px";
      };
      // Initialize pen width display
      if (penWidthEl && document.getElementById("penWidthValue")) {
        document.getElementById("penWidthValue").textContent = penWidthEl.value + "px";
      }
      highColorEl.oninput = () => (highColor = highColorEl.value);
      textColorEl.oninput = () => {
        textColor = textColorEl.value;
        if (selectedAnn && selectedAnn.classList.contains("ann-text")) {
          selectedAnn.querySelector(".text").style.color = textColor;
          const p = pages.find((pg) => pg.annLayer.contains(selectedAnn));
          emit("annotation:updated", { id: selectedAnn.dataset.annoId, type: "text", page: p.num, rect: getRectData(selectedAnn), reason: "text-color", updatedAt: Date.now() });
        }
      };
      function updateZoomLabel() {
        zoomLabel.textContent = Math.round(zoom * 100) + "%";
      }
      function clampZoom(z) {
        return Math.max(0.25, Math.min(3, z));
      }
      function pt(evt, wrap) {
        const vp = wrap.querySelector(".page-viewport");
        const r = vp.getBoundingClientRect();
        const x = (evt.clientX - r.left) / zoom,
          y = (evt.clientY - r.top) / zoom;
        return { x: Math.max(0, Math.min(vp.offsetWidth, x)), y: Math.max(0, Math.min(vp.offsetHeight, y)) };
      }
      function clearSelection() {
        docEl.querySelectorAll(".ann[data-selected=true],.ann-text[data-selected=true]").forEach((n) => n.removeAttribute("data-selected"));
        selectedAnn = null;
        docEl.querySelectorAll("g.svg-delete[data-visible=true]").forEach((g) => g.setAttribute("data-visible", "false"));
        if (selectedPath) selectedPath.removeAttribute("data-selected");
        selectedPath = null;
      }

      /* Fit-width base scale */
      function computeBaseScale(pageWidthAt1) {
        const pad = 32;
        const avail = Math.max(MIN_CSS_WIDTH, Math.min(MAX_CSS_WIDTH, stage.clientWidth - pad));
        return Math.max(0.5, Math.min(3.0, avail / pageWidthAt1));
      }

      /* ================= Build (hi-DPI, narrow fit) ================= */
      async function build() {
        docEl.innerHTML = "";
        pages.length = 0;
        clearHits();

        const first = await pdfDoc.getPage(1);
        const vp1 = first.getViewport({ scale: 1 });
        baseScale = computeBaseScale(vp1.width);

        for (let i = 1; i <= pdfDoc.numPages; i++) {
          const page = i === 1 ? first : await pdfDoc.getPage(i);
          const vp1p = page.getViewport({ scale: 1 });
          const renderVp = page.getViewport({ scale: baseScale * DPR });
          const cssW = Math.round(vp1p.width * baseScale);
          const cssH = Math.round(vp1p.height * baseScale);

          const outer = document.createElement("div");
          outer.className = "page-outer";
          const wrap = document.createElement("div");
          wrap.className = "page-wrap";
          wrap.dataset.index = i;
          const viewportEl = document.createElement("div");
          viewportEl.className = "page-viewport";
          viewportEl.style.width = cssW + "px";
          viewportEl.style.height = cssH + "px";
          viewportEl.style.transform = `scale(${zoom})`;
          const canvas = document.createElement("canvas");
          canvas.className = "pdf";
          canvas.width = Math.round(renderVp.width);
          canvas.height = Math.round(renderVp.height);
          canvas.style.width = cssW + "px";
          canvas.style.height = cssH + "px";
          const annLayer = document.createElement("div");
          annLayer.className = "ann-layer";
          const hitsLayer = document.createElement("div");
          Object.assign(hitsLayer.style, { position: "absolute", inset: "0", pointerEvents: "none", zIndex: "1" });
          const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
          svg.setAttribute("viewBox", `0 0 ${cssW} ${cssH}`);
          svg.setAttribute("width", cssW);
          svg.setAttribute("height", cssH);

          viewportEl.append(canvas, annLayer);
          annLayer.append(hitsLayer, svg);
          wrap.append(viewportEl);
          outer.append(wrap);
          docEl.append(outer);

          const ctx = canvas.getContext("2d");
          ctx.setTransform(1, 0, 0, 1, 0, 0);
          await page.render({ canvasContext: ctx, viewport: renderVp }).promise;

          const tc = await page.getTextContent().catch(() => null);
          const textItems = (tc ? tc.items : []).map((it) => {
            const tr = it.transform || [1, 0, 0, 1, 0, 0];
            const x = tr[4] * baseScale,
              yBase = tr[5] * baseScale,
              h = Math.abs(tr[3]) * baseScale || 12;
            const w = (it.width || it.str.length * (Math.abs(tr[0]) || h * 0.6)) * baseScale;
            return { str: it.str, x, yBase, h, w };
          });

          pages.push({ num: i, outer, wrap, viewportEl, canvas, svg, annLayer, hitsLayer, baseW: cssW, baseH: cssH, textItems });
        }

        layout();
        setupPageObserver();
        // Keep the current page centered after rebuild
        requestAnimationFrame(() => scrollToPage(currentPage));
        if (searchQuery) paintSearch(searchQuery);
      }

      /* Layout (CSS zoom only) */
      function layout() {
        for (const p of pages) {
          p.viewportEl.style.transform = `scale(${zoom})`;
          p.outer.style.width = p.baseW * zoom + "px";
          p.outer.style.height = p.baseH * zoom + "px";
        }
        updateZoomLabel();
      }

      /* Rebuild on resize */
      let rT = null;
      window.addEventListener("resize", () => {
        if (!pdfDoc) return;
        clearTimeout(rT);
        rT = setTimeout(() => build(), 140);
      });

      /* ================= Accurate page centering & observer ================= */
      function pageTopInStage(outerEl) {
        const sRect = stage.getBoundingClientRect();
        const pRect = outerEl.getBoundingClientRect();
        return stage.scrollTop + (pRect.top - sRect.top);
      }
      function scrollToPage(n) {
        const p = pages[n - 1];
        if (!p) return;
        const top = pageTopInStage(p.outer);
        const target = Math.max(0, top - (stage.clientHeight - p.outer.clientHeight) / 2);
        pendingPage = n;
        stage.scrollTo({ top: target, behavior: "smooth" });
        clearTimeout(scrollToPage._t);
        scrollToPage._t = setTimeout(() => {
          if (pendingPage === n) {
            currentPage = n;
            pendingPage = null;
          }
        }, 1000);
      }

      let pageIO = null;
      function setupPageObserver() {
        if (pageIO && pageIO.disconnect) pageIO.disconnect();
        pageIO = new IntersectionObserver(
          (entries) => {
            let best = null;
            for (const e of entries) {
              if (!e.isIntersecting) continue;
              if (!best || e.intersectionRatio > best.intersectionRatio) best = e;
            }
            if (!best) return;
            const n = +best.target.querySelector(".page-wrap").dataset.index;

            if (pendingPage !== null) {
              if (n === pendingPage) {
                currentPage = n;
                pendingPage = null;
                emit("page:changed", { page: n });
              }
              return; // ignore while locked
            }
            if (n !== currentPage) {
              currentPage = n;
              emit("page:changed", { page: n });
            }
          },
          { root: stage, threshold: [0, 0.25, 0.5, 0.65, 0.8, 0.95, 1] }
        );
        for (const p of pages) pageIO.observe(p.outer);
      }

      /* ================= Pen / Highlighter ================= */
      function startStroke(evt, pg, isHigh) {
        isDrawing = true;
        clearSelection();
        const { x, y } = pt(evt, pg.wrap);
        const id = uid();
        const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
        path.setAttribute("data-id", id);
        path.setAttribute("data-type", isHigh ? "highlight" : "pen");
        path.setAttribute("fill", "none");
        path.setAttribute("stroke-linecap", "round");
        path.setAttribute("stroke-linejoin", "round");
        path.setAttribute("stroke-width", isHigh ? String(Math.max(8, penWidth * 5)) : String(penWidth));
        if (isHigh) {
          const { r, g, b } = hexToRgb(highColor);
          path.setAttribute("stroke", `rgba(${r},${g},${b},0.35)`);
          path.style.mixBlendMode = "multiply";
        } else path.setAttribute("stroke", penColor);
        path._points = [{ x, y }];
        path._pageNum = pg.num;
        path.setAttribute("d", `M${x},${y}`);
        const del = makeDeleteBtnSVG(path, pg.svg);
        del.setAttribute("data-visible", "false");
        pg.svg.append(path, del);
        currPath = path;
      }
      function moveStroke(evt) {
        if (!isDrawing || !currPath) return;
        const wrap = currPath.ownerSVGElement.closest(".page-wrap");
        const { x, y } = pt(evt, wrap);
        currPath._points.push({ x, y });
        currPath.setAttribute(
          "d",
          `M${currPath._points[0].x},${currPath._points[0].y} ` +
            currPath._points
              .slice(1)
              .map((p) => `L${p.x},${p.y}`)
              .join(" ")
        );
      }
      function endStroke() {
        if (!isDrawing || !currPath) {
          isDrawing = false;
          currPath = null;
          return;
        }
        emit("annotation:created", { id: currPath.getAttribute("data-id"), type: currPath.getAttribute("data-type"), page: currPath._pageNum, points: currPath._points.slice(), createdAt: Date.now() });
        isDrawing = false;
        currPath = null;
      }
      function makeDeleteBtnSVG(targetPath, svgRoot) {
        const g = document.createElementNS("http://www.w3.org/2000/svg", "g");
        g.setAttribute("data-for", targetPath.getAttribute("data-id"));
        g.setAttribute("class", "svg-delete");
        const c = document.createElementNS("http://www.w3.org/2000/svg", "circle");
        c.setAttribute("r", "10");
        c.setAttribute("fill", "#ef4444");
        const t = document.createElementNS("http://www.w3.org/2000/svg", "text");
        t.textContent = "";
        t.setAttribute("fill", "#fff");
        t.setAttribute("font-size", "14");
        t.setAttribute("text-anchor", "middle");
        t.setAttribute("dy", "4");
        function place() {
          try {
            const b = targetPath.getBBox();
            g.setAttribute("transform", `translate(${b.x + b.width + 6},${b.y - 6})`);
          } catch {}
        }
        place();
        svgRoot.addEventListener("mouseup", place, { once: true });
        g.append(c, t);
        g.addEventListener("click", () => {
          if (targetPath.getAttribute("data-locked") === "true") return;
          const id = targetPath.getAttribute("data-id");
          const del = svgRoot.querySelector(`g.svg-delete[data-for="${id}"]`);
          const type = targetPath.getAttribute("data-type");
          const page = Number(svgRoot.closest(".page-wrap").dataset.index);
          targetPath.remove();
          if (del) del.remove();
          clearSelection();
          emit("annotation:deleted", { id, type, page, deletedAt: Date.now() });
        });
        return g;
      }

      /* ================= Image & Text ================= */
      function selectAnn(el) {
        clearSelection();
        el.setAttribute("data-selected", "true");
        selectedAnn = el;
      }
      function setBoxStyleFromData(el) {
        const x = +el.dataset.x,
          y = +el.dataset.y,
          w = +el.dataset.w,
          h = +el.dataset.h;
        Object.assign(el.style, { left: x + "px", top: y + "px", width: w + "px", height: h + "px" });
      }
      function getRectData(el) {
        return { x: +el.dataset.x, y: +el.dataset.y, width: +el.dataset.w, height: +el.dataset.h };
      }

      function placeImageAt(evt, pg, dataURL) {
        const { x, y } = pt(evt, pg.wrap);
        return placeImageAtXY(pg, x, y, dataURL);
      }
      function placeImageAtXY(pg, x, y, dataURL, w = 200, h = 140) {
        const img = new Image();
        img.src = dataURL;
        img.draggable = false;
        const ann = document.createElement("div");
        ann.className = "ann";
        ann.dataset.type = "image";
        ann.dataset.annoId = uid();
        Object.assign(ann.dataset, { x, y, w, h });
        setBoxStyleFromData(ann);
        const del = document.createElement("button");
        del.className = "delete";
        del.textContent = "";
        del.onclick = (e) => {
          e.stopPropagation();
          if (ann.dataset.locked === "true") return;
          const id = ann.dataset.annoId;
          const page = pg.num;
          ann.remove();
          clearSelection();
          emit("annotation:deleted", { id, type: "image", page, rect: getRectData(ann), deletedAt: Date.now() });
        };
        const res = document.createElement("div");
        res.className = "resize";
        res.title = "Resize";
        ann.append(img, del, res);
        pg.annLayer.append(ann);
        selectAnn(ann);
        enableDrag(ann, pg);
        enableResizeBox(ann, pg, res);
        emit("annotation:created", { id: ann.dataset.annoId, type: "image", page: pg.num, rect: getRectData(ann), createdAt: Date.now() });
        return ann;
      }

      function placeTextAt(evt, pg) {
        const { x, y } = pt(evt, pg.wrap);
        const ann = document.createElement("div");
        ann.className = "ann-text";
        ann.dataset.type = "text";
        ann.dataset.annoId = uid();
        Object.assign(ann.dataset, { x, y, w: 220, h: 60 });
        setBoxStyleFromData(ann);
        const text = document.createElement("div");
        text.className = "text";
        text.contentEditable = "true";
        text.spellcheck = false;
        text.textContent = "Type";
        text.style.color = textColor;
        text.addEventListener("focus", () => {
          if (text.textContent === "Type") text.textContent = "";
          if (ann.dataset.locked === "true") text.blur();
        });
        // emit updates when content changes
        text.addEventListener("input", () => {
          if (ann.dataset.locked === "true") return;
          const p = pages.find((pg) => pg.annLayer.contains(ann));
          emit("annotation:updated", {
            id: ann.dataset.annoId,
            type: "text",
            page: p.num,
            rect: getRectData(ann),
            reason: "text-change",
            updatedAt: Date.now(),
          });
        });

        const del = document.createElement("button");
        del.className = "delete";
        del.textContent = "";
        del.onclick = (e) => {
          e.stopPropagation();
          if (ann.dataset.locked === "true") return;
          const id = ann.dataset.annoId;
          const page = pg.num;
          ann.remove();
          clearSelection();
          emit("annotation:deleted", { id, type: "text", page, rect: getRectData(ann), deletedAt: Date.now() });
        };
        const res = document.createElement("div");
        res.className = "resize";
        res.title = "Resize box";
        ann.append(text, del, res);
        pg.annLayer.append(ann);
        selectAnn(ann);
        setTimeout(() => text.focus(), 0);
        enableDrag(ann, pg);
        enableResizeBox(ann, pg, res);
        emit("annotation:created", { id: ann.dataset.annoId, type: "text", page: pg.num, rect: getRectData(ann), createdAt: Date.now() });
      }
      docEl.addEventListener("dblclick", (e) => {
        const t = e.target.closest(".ann-text .text");
        if (t) t.focus();
      });

      function enableDrag(el, pg) {
        el.addEventListener("pointerdown", (e) => {
          if (tool !== "select") return;
          if (e.target.classList.contains("delete") || e.target.classList.contains("resize") || e.target.classList.contains("lock-icon")) return;
          selectAnn(el);
          // Check if locked - prevent dragging
          if (el.dataset.locked === "true") return;
          const r = pg.viewportEl.getBoundingClientRect();
          const x = (e.clientX - r.left) / zoom,
            y = (e.clientY - r.top) / zoom;
          dragTarget = el;
          dragOffset.x = x - +el.dataset.x;
          dragOffset.y = y - +el.dataset.y;
          if (el.setPointerCapture) el.setPointerCapture(e.pointerId);
          e.preventDefault();
        });
      }
      function enableResizeBox(el, pg, handle) {
        handle.addEventListener("pointerdown", (e) => {
          if (tool !== "select") return;
          e.stopPropagation();
          selectAnn(el);
          // Check if locked - prevent resizing
          if (el.dataset.locked === "true") return;
          const r = pg.viewportEl.getBoundingClientRect();
          const x = (e.clientX - r.left) / zoom,
            y = (e.clientY - r.top) / zoom;
          resizeTarget = el;
          resizeStart = { x0: x, y0: y, w: +el.dataset.w, h: +el.dataset.h };
          if (handle.setPointerCapture) handle.setPointerCapture(e.pointerId);
        });
      }
      window.addEventListener("pointermove", (e) => {
        if (dragTarget) {
          const p = pages.find((pg) => pg.annLayer.contains(dragTarget));
          const r = p.viewportEl.getBoundingClientRect();
          const x = (e.clientX - r.left) / zoom,
            y = (e.clientY - r.top) / zoom;
          dragTarget.dataset.x = Math.max(0, Math.min(p.baseW - dragTarget.offsetWidth / zoom, x - dragOffset.x));
          dragTarget.dataset.y = Math.max(0, Math.min(p.baseH - dragTarget.offsetHeight / zoom, y - dragOffset.y));
          setBoxStyleFromData(dragTarget);
        }
        if (resizeTarget && resizeStart) {
          const p = pages.find((pg) => pg.annLayer.contains(resizeTarget));
          const r = p.viewportEl.getBoundingClientRect();
          const x = (e.clientX - r.left) / zoom,
            y = (e.clientY - r.top) / zoom;
          const dw = x - resizeStart.x0,
            dh = y - resizeStart.y0;
          const newW = Math.max(60, resizeStart.w + dw);
          const newH = Math.max(30, resizeStart.h + dh);
          resizeTarget.dataset.w = Math.min(newW, p.baseW - +resizeTarget.dataset.x);
          resizeTarget.dataset.h = Math.min(newH, p.baseH - +resizeTarget.dataset.y);
          setBoxStyleFromData(resizeTarget);
        }
      });
      window.addEventListener("pointerup", () => {
        if (dragTarget) {
          const p = pages.find((pg) => pg.annLayer.contains(dragTarget));
          const type = dragTarget.classList.contains("ann-text") ? "text" : "image";
          emit("annotation:updated", { id: dragTarget.dataset.annoId, type, page: p.num, rect: getRectData(dragTarget), reason: "move", updatedAt: Date.now() });
        }
        if (resizeTarget) {
          const p = pages.find((pg) => pg.annLayer.contains(resizeTarget));
          const type = resizeTarget.classList.contains("ann-text") ? "text" : "image";
          emit("annotation:updated", { id: resizeTarget.dataset.annoId, type, page: p.num, rect: getRectData(resizeTarget), reason: "resize", updatedAt: Date.now() });
        }
        dragTarget = null;
        resizeTarget = null;
        resizeStart = null;
      });

      /* Selection clicks */
      docEl.addEventListener("click", (e) => {
        if (tool !== "select") return;
        const ann = e.target.closest(".ann,.ann-text");
        if (ann) {
          selectAnn(ann);
          return;
        }
        const path = e.target.closest("path");
        if (path) {
          clearSelection();
          selectedPath = path;
          selectedPath.setAttribute("data-selected", "true");
          const svg = selectedPath.ownerSVGElement;
          const id = selectedPath.getAttribute("data-id");
          var g = svg.querySelector('g.svg-delete[data-for="' + id + '"]');
          if (g) g.setAttribute("data-visible", "true");
          return;
        }
        if (e.target.closest(".page-outer")) clearSelection();
      });

      /* ===== Lock/Unlock Annotations ===== */
      function toggleAnnotationLock(element) {
        if (!element) return;
        const isLocked = element.dataset.locked === "true";
        if (isLocked) {
          element.removeAttribute("data-locked");
          emit("annotation:unlocked", { id: element.dataset.annoId || element.getAttribute("data-id"), unlockedAt: Date.now() });
        } else {
          element.dataset.locked = "true";
          emit("annotation:locked", { id: element.dataset.annoId || element.getAttribute("data-id"), lockedAt: Date.now() });
        }
      }

      // Lock annotation (without unlocking if already locked)
      function lockAnnotation(element) {
        if (!element) return;
        if (element.dataset) {
          element.dataset.locked = "true";
        } else {
          element.setAttribute("data-locked", "true");
        }
        emit("annotation:locked", { id: element.dataset?.annoId || element.getAttribute("data-id"), lockedAt: Date.now() });
      }

      // Find and lock stamp annotation (on page 1)
      function lockStampAnnotation() {
        const stampEl = findStampOnPage1();
        if (stampEl) {
          lockAnnotation(stampEl);
          console.log("Stamp annotation locked");
          return true;
        } else {
          console.log("No stamp annotation found");
          return false;
        }
      }

      // Lock all annotations (pen, highlighter, text, and images)
      function lockAllAnnotations() {
        let count = 0;

        // Lock all SVG path annotations (pen/highlighter)
        for (const p of pages) {
          const paths = p.svg.querySelectorAll("path[data-id]");
          paths.forEach((path) => {
            if (path.getAttribute("data-locked") !== "true") {
              path.setAttribute("data-locked", "true");
              emit("annotation:locked", { id: path.getAttribute("data-id"), lockedAt: Date.now() });
              count++;
            }
          });
        }

        // Lock all image and text annotations
        for (const p of pages) {
          const annotations = p.annLayer.querySelectorAll(".ann, .ann-text");
          annotations.forEach((ann) => {
            if (ann.dataset.locked !== "true") {
              ann.dataset.locked = "true";
              emit("annotation:locked", { id: ann.dataset.annoId, lockedAt: Date.now() });
              count++;
            }
          });
        }

        console.log(`Locked ${count} annotation(s)`);
        return count;
      }

      // Enable/disable auto-export on emit
      function enableAutoExport() {
        autoExportOnEmit = true;
        console.log("Auto-export enabled - annotations will export immediately when emit is called");
      }

      function disableAutoExport() {
        autoExportOnEmit = false;
        console.log("Auto-export disabled");
      }

      // Export annotations to JSON string (returns the JSON string)
      function exportAnnotationsToJSON() {
        const annotationsData = exportAnnotationsJSON();
        return JSON.stringify(annotationsData, null, 2);
      }

      // Export annotations and download immediately
      function exportAndDownloadAnnotations() {
        const annotationsData = exportAnnotationsJSON();
        const blob = new Blob([JSON.stringify(annotationsData, null, 2)], { type: "application/json" });
        const url = URL.createObjectURL(blob);
        const base = currentName.replace(/\.pdf$/i, "") || "document";
        const a = document.createElement("a");
        a.href = url;
        a.download = `${base}-annotations.json`;
        document.body.appendChild(a);
        a.click();
        a.remove();
        URL.revokeObjectURL(url);
        console.log("Annotations exported and downloaded");
      }

      // Delete annotation by ID
      function deleteAnnotationById(id) {
        if (!id) {
          console.error("No annotation ID provided");
          return false;
        }

        // Search and delete SVG path annotations (pen/highlighter)
        for (const p of pages) {
          const path = p.svg.querySelector(`path[data-id="${id}"]`);
          if (path) {
            // Check if locked
            if (path.getAttribute("data-locked") === "true") {
              console.warn(`Annotation ${id} is locked and cannot be deleted`);
              return false;
            }

            const type = path.getAttribute("data-type");
            const page = p.num;

            // Remove delete button if exists
            const delBtn = p.svg.querySelector(`g.svg-delete[data-for="${id}"]`);
            if (delBtn) delBtn.remove();

            // Remove the path
            path.remove();

            // Clear selection if this was selected
            if (selectedPath === path) {
              clearSelection();
            }

            // Emit deletion event
            emit("annotation:deleted", { id, type, page, deletedAt: Date.now() });

            console.log(`Annotation ${id} (${type}) deleted from page ${page}`);
            return true;
          }
        }

        // Search and delete image/text annotations
        for (const p of pages) {
          const ann = p.annLayer.querySelector(`[data-anno-id="${id}"]`);
          if (ann) {
            // Check if locked
            if (ann.dataset.locked === "true") {
              console.warn(`Annotation ${id} is locked and cannot be deleted`);
              return false;
            }

            const type = ann.classList.contains("ann-text") ? "text" : "image";
            const page = p.num;
            const rect = {
              x: +ann.dataset.x,
              y: +ann.dataset.y,
              width: +ann.dataset.w,
              height: +ann.dataset.h,
            };

            // Clear selection if this was selected
            if (selectedAnn === ann) {
              clearSelection();
            }

            // Remove the annotation
            ann.remove();

            // Emit deletion event
            emit("annotation:deleted", { id, type, page, rect, deletedAt: Date.now() });

            console.log(`Annotation ${id} (${type}) deleted from page ${page}`);
            return true;
          }
        }

        console.error(`Annotation ${id} not found`);
        return false;
      }

      // Check if annotations contains only stamp or other annotations as well
      // Returns true if only stamp exists, false if there are other annotations or no stamp
      function hasOnlyStampAnnotation() {
        let hasStamp = false;
        let hasOtherAnnotations = false;

        // Check for pen/highlighter strokes (SVG paths)
        for (const p of pages) {
          const paths = p.svg.querySelectorAll("path[data-id]");
          if (paths.length > 0) {
            hasOtherAnnotations = true;
            break; // Early exit if other annotations found
          }
        }

        // Check for image and text annotations
        if (!hasOtherAnnotations) {
          for (const p of pages) {
            // Check images
            const images = p.annLayer.querySelectorAll('.ann[data-type="image"]');
            for (const img of images) {
              if (img.dataset.stamp === "true") {
                hasStamp = true;
              } else {
                hasOtherAnnotations = true;
                break;
              }
            }

            if (hasOtherAnnotations) break;

            // Check text annotations
            const texts = p.annLayer.querySelectorAll('.ann-text[data-type="text"]');
            if (texts.length > 0) {
              hasOtherAnnotations = true;
              break;
            }
          }
        }

        // Return true only if stamp exists and no other annotations
        return hasStamp && !hasOtherAnnotations;
      }

      // Export PDF with annotations without loading into canvas
      async function exportPDFWithAnnotations(pdfBytes, annotationsData) {
        try {
          // Parse annotations
          const annotations = Array.isArray(annotationsData.annotations) ? annotationsData.annotations : Array.isArray(annotationsData) ? annotationsData : [];

          if (!annotations.length) {
            console.warn("No annotations to embed");
            return pdfBytes;
          }

          // Load the PDF with pdf-lib
          const pdf = await PDFDocument.load(pdfBytes);
          const helvetica = await pdf.embedStandardFont(StandardFonts.Helvetica);

          // Group annotations by page
          const annotationsByPage = {};
          annotations.forEach((ann) => {
            const pageNum = ann.page || 1;
            if (!annotationsByPage[pageNum]) {
              annotationsByPage[pageNum] = [];
            }
            annotationsByPage[pageNum].push(ann);
          });

          // Process each page
          for (const [pageNum, pageAnnotations] of Object.entries(annotationsByPage)) {
            const pageIndex = parseInt(pageNum) - 1;
            if (pageIndex < 0 || pageIndex >= pdf.getPageCount()) continue;

            const page = pdf.getPage(pageIndex);
            const { width: pdfW, height: pdfH } = page.getSize();

            // Assume standard page width for scale calculation (800px is typical for A4 at 96 DPI)
            const assumedBaseWidth = 800;
            const scaleFactor = pdfW / assumedBaseWidth;

            for (const ann of pageAnnotations) {
              try {
                if (ann.type === "image" && ann.src) {
                  // Embed image annotation
                  const rect = ann.rect || {};
                  const x = (rect.x || 0) * scaleFactor;
                  const w = (rect.width || 200) * scaleFactor;
                  const h = (rect.height || 140) * scaleFactor;
                  const y = pdfH - (rect.y || 0) * scaleFactor - h;

                  // Parse image data
                  if (ann.src.startsWith("data:image")) {
                    const parsed = parseDataUrl(ann.src);
                    if (parsed && parsed.bytes) {
                      const isPngImage = isPng(parsed.bytes);
                      const isJpgImage = isJpg(parsed.bytes);

                      if (isPngImage) {
                        const embeddedImage = await pdf.embedPng(parsed.bytes);
                        page.drawImage(embeddedImage, { x, y, width: w, height: h });
                      } else if (isJpgImage) {
                        const embeddedImage = await pdf.embedJpg(parsed.bytes);
                        page.drawImage(embeddedImage, { x, y, width: w, height: h });
                      }
                    }
                  }
                } else if (ann.type === "text" && ann.text) {
                  // Embed text annotation
                  const rect = ann.rect || {};
                  const fontSize = (ann.fontSize || 18) * scaleFactor;
                  const x = (rect.x || 0) * scaleFactor;
                  const y = pdfH - (rect.y || 0) * scaleFactor - fontSize * 0.2;

                  // Parse color
                  let textColor = rgb(0, 0, 0);
                  if (ann.color) {
                    const colorMatch = ann.color.match(/\d+(\.\d+)?/g);
                    if (colorMatch && colorMatch.length >= 3) {
                      textColor = rgb((+colorMatch[0] || 0) / 255, (+colorMatch[1] || 0) / 255, (+colorMatch[2] || 0) / 255);
                    }
                  }

                  // Draw text lines
                  const lines = ann.text.split(/\n/);
                  const leading = fontSize * 1.25;
                  lines.forEach((line, idx) => {
                    if (line.trim()) {
                      page.drawText(line, {
                        x,
                        y: y - idx * leading,
                        size: fontSize,
                        font: helvetica,
                        color: textColor,
                      });
                    }
                  });
                } else if ((ann.type === "pen" || ann.type === "highlight") && ann.points && ann.points.length > 0) {
                  // For pen/highlight - we'll skip these as they require canvas rendering
                  // In a real implementation, you'd need to render SVG paths to a canvas
                  console.log(`Skipping ${ann.type} annotation - requires canvas rendering`);
                }
              } catch (err) {
                console.error(`Error processing annotation on page ${pageNum}:`, err);
              }
            }
          }

          // Save and return the modified PDF
          const modifiedPdfBytes = await pdf.save();
          return modifiedPdfBytes;
        } catch (error) {
          console.error("Error exporting PDF with annotations:", error);
          throw error;
        }
      }

      // Expose functions globally for easy access
      window.lockStampAnnotation = lockStampAnnotation;
      window.lockAllAnnotations = lockAllAnnotations;
      window.enableAutoExport = enableAutoExport;
      window.disableAutoExport = disableAutoExport;
      window.exportAnnotationsToJSON = exportAnnotationsToJSON;
      window.exportAndDownloadAnnotations = exportAndDownloadAnnotations;
      window.findAnnotationById = findAnnotationById;
      window.deleteAnnotationById = deleteAnnotationById;
      window.hasOnlyStampAnnotation = hasOnlyStampAnnotation;
      window.exportPDFWithAnnotations = exportPDFWithAnnotations;

      /* Entry dispatch */
      docEl.addEventListener("pointerdown", (evt) => {
        if (!pdfDoc) return;
        const outer = evt.target.closest(".page-outer");
        if (!outer) return;
        const pg = pages.find((p) => p.outer === outer);
        if (tool === "pen") startStroke(evt, pg, false);
        else if (tool === "high") startStroke(evt, pg, true);
        else if (tool === "text" && !evt.target.closest(".ann,.ann-text")) placeTextAt(evt, pg);
        else if (tool === "image" && imageArmed && pendingImageDataURL && !evt.target.closest(".ann,.ann-text")) {
          placeImageAt(evt, pg, pendingImageDataURL);
          imageArmed = false;
          pendingImageDataURL = null;
          setTool("select");
          imgInput.value = "";
          evt.preventDefault();
          evt.stopPropagation();
        }
      });
      docEl.addEventListener("pointermove", (e) => {
        if (tool === "pen" || tool === "high") moveStroke(e);
      });
      window.addEventListener("pointerup", () => {
        if (tool === "pen" || tool === "high") endStroke();
      });

      /* Delete key */
      window.addEventListener("keydown", (e) => {
        if (e.key !== "Delete" && e.key !== "Backspace") return;
        if (selectedAnn) {
          // Check if locked - prevent deletion
          if (selectedAnn.dataset.locked === "true") return;
          const p = pages.find((pg) => pg.annLayer.contains(selectedAnn));
          const id = selectedAnn.dataset.annoId;
          const type = selectedAnn.classList.contains("ann-text") ? "text" : "image";
          const rect = getRectData(selectedAnn);
          selectedAnn.remove();
          clearSelection();
          emit("annotation:deleted", { id, type, page: p.num, rect, deletedAt: Date.now() });
          return;
        }
        if (selectedPath) {
          // Check if locked - prevent deletion
          if (selectedPath.getAttribute("data-locked") === "true") return;
          const svg = selectedPath.ownerSVGElement;
          const id = selectedPath.getAttribute("data-id");
          const type = selectedPath.getAttribute("data-type");
          svg.querySelector(`g.svg-delete[data-for="${id}"]`)?.remove();
          const p = pages.find((pg) => pg.svg === svg);
          selectedPath.remove();
          clearSelection();
          emit("annotation:deleted", { id, type, page: p ? p.num : 1, deletedAt: Date.now() });
        }
      });

      // Keyboard niceties: Esc clears selection; Ctrl/Cmd+S triggers export
      window.addEventListener("keydown", (e) => {
        if (e.key === "Escape") clearSelection();
        if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === "s") {
          e.preventDefault();
          exportBtn.click();
        }
      });

      /* Zoom */
      function setZoom(z) {
        zoom = clampZoom(z);
        layout();
        if (searchQuery) paintSearch(searchQuery);
      }
      zoomInBtn.onclick = () => setZoom(zoom * 1.15);
      zoomOutBtn.onclick = () => setZoom(zoom / 1.15);
      zoomResetBtn.onclick = () => setZoom(1);

      // Pinch/gesture zoom on trackpads
      stage.addEventListener(
        "wheel",
        (e) => {
          if (!(e.ctrlKey || e.metaKey)) return;
          e.preventDefault();
          const factor = e.deltaY > 0 ? 1 / 1.1 : 1.1;
          setZoom(zoom * factor);
        },
        { passive: false }
      );

      /* ===== Search (whole-word) ===== */
      function clearHits() {
        for (const p of pages) p.hitsLayer.innerHTML = "";
        allHits.length = 0;
        hitIndex = -1;
      }
      function paintSearch(q) {
        clearHits();
        if (!q) return;
        const needle = q.trim().toLowerCase();
        if (!needle) return;
        for (const p of pages) {
          for (const it of p.textItems || []) {
            const s = it.str || "";
            if (!s) continue;
            let tokenRe;
            try {
              tokenRe = /\b[\p{L}\p{N}_]+\b/gu;
            } catch {
              tokenRe = /\b[\w]+\b/g;
            }
            let m;
            while ((m = tokenRe.exec(s)) !== null) {
              const tok = m[0];
              if (tok.toLowerCase() !== needle) continue;
              const idx = m.index;
              const avgW = it.w / Math.max(1, s.length);
              const x = it.x + avgW * idx,
                w = Math.max(6, avgW * tok.length),
                h = it.h * 1.15,
                top = p.baseH - it.yBase - h * 0.15;
              const hit = document.createElement("div");
              hit.className = "hit";
              Object.assign(hit.style, { left: x + "px", top: top + "px", width: w + "px", height: h + "px" });
              p.hitsLayer.append(hit);
              allHits.push({ page: p.num, x, y: p.baseH - it.yBase, w, h });
            }
          }
        }
      }
      function gotoHit(dir) {
        if (allHits.length === 0) return;
        hitIndex = (hitIndex + dir + allHits.length) % allHits.length;
        const h = allHits[hitIndex];
        const p = pages[h.page - 1];
        if (!p) return;
        const pageTop = pageTopInStage(p.outer);
        const targetTop = Math.max(0, pageTop + h.y * zoom - stage.clientHeight * 0.35);
        pendingPage = h.page;
        stage.scrollTo({ top: targetTop, behavior: "smooth" });
      }
      searchInput.addEventListener("input", () => {
        searchQuery = searchInput.value;
        paintSearch(searchQuery);
      });
      searchPrev.onclick = () => gotoHit(-1);
      searchNext.onclick = () => gotoHit(+1);

      /* Image picker */
      imgInput.addEventListener("change", (e) => {
        const f = e.target.files?.[0];
        if (!(f && f.type.startsWith("image/"))) return;
        const fr = new FileReader();
        fr.onload = () => {
          pendingImageDataURL = fr.result;
          imageArmed = true;
          setTool("image");
        };
        fr.readAsDataURL(f);
      });

      /* Stamps (page 1 corners) */
      stampFile.addEventListener("change", (e) => {
        const f = e.target.files?.[0];
        if (!(f && f.type.startsWith("image/"))) return;
        const fr = new FileReader();
        fr.onload = () => {
          stampDataURL = fr.result;
        };
        fr.readAsDataURL(f);
      });
      function ensureStampReady() {
        if (!pdfDoc) {
          alert("Open a PDF first.");
          return false;
        }
        if (!stampDataURL) {
          alert("Choose a stamp image first.");
          return false;
        }
        return true;
      }
      // ----- Stamp detection helpers -----
      function findStampOnPage1() {
        const p1 = pages[0];
        if (!p1) return null;
        // Prefer explicit marker
        const marked = p1.annLayer.querySelector('.ann[data-stamp="true"]');
        if (marked) return marked;
        // Fallback: any image annotation whose <img> src matches the current stamp image
        if (stampDataURL) {
          const imgs = Array.from(p1.annLayer.querySelectorAll('.ann[data-type="image"] img'));
          const hit = imgs.find((im) => im.src === stampDataURL);
          return hit ? hit.closest(".ann") : null;
        }
        return null;
      }
      function hasStamp() {
        return !!findStampOnPage1();
      }
      // Expose for quick checks from console or other scripts
      window.hasStamp = hasStamp;
      window.getStampEl = findStampOnPage1;
      //if (!stampDataURL)
      //{
      //    alert('Choose a stamp image first.');
      //    return false;
      //}
      //else { return true; }
      function placeStamp(c) {
        if (!ensureStampReady()) return;
        const p1 = pages[0];
        const m = 16;
        const size = +stampSizeEl.value || 140;
        let x = m,
          y = m,
          w = size,
          h = size;
        if (c === "TR") x = p1.baseW - m - w;
        if (c === "BR") {
          x = p1.baseW - m - w;
          y = p1.baseH - m - h;
        }
        if (c === "BL") {
          x = m;
          y = p1.baseH - m - h;
        }
        const stampEl = placeImageAtXY(p1, x, y, stampDataURL, w, h);
        stampEl.dataset.stamp = "true";
        scrollToPage(1);
      }
      btnTL.onclick = () => placeStamp("TL");
      btnTR.onclick = () => placeStamp("TR");
      btnBR.onclick = () => placeStamp("BR");
      btnBL.onclick = () => placeStamp("BL");

      /* --- Stamp URL hook --- */
      (function () {
        var el = document.getElementById("stampUseUrl");
        var input = document.getElementById("stampUrl");
        if (!el || !input) return;
        el.addEventListener("click", function () {
          var url = (input.value || "").trim();
          if (!url) {
            alert("Paste an image URL first.");
            return;
          }
          try {
            var test = new Image();
            test.onload = function () {
              stampDataURL = url;
              alert("Stamp image set. Use TL/TR/BR/BL to place.");
            };
            test.onerror = function () {
              alert("Could not load image from that URL.");
            };
            test.src = url;
          } catch (e) {
            alert("Invalid URL.");
          }
        });
      })();

      /* --- Import annotations (JSON) --- */
      (function () {
        var input = document.getElementById("import-json");
        if (!input) return;
        input.addEventListener("change", async function (e) {
          try {
            var f = e.target.files && e.target.files[0];
            if (!f) return;
            var text = await f.text();
            var data;
            try {
              data = JSON.parse(text);
            } catch (err) {
              alert("Invalid JSON");
              return;
            }
            importAnnotations(data);
          } catch (err) {
            console.error(err);
            alert("Failed to import annotations.");
          } finally {
            input.value = "";
          }
        });
      })();
      function importAnnotations(data) {
        if (!pdfDoc) {
          alert("Open a PDF first.");
          return;
        }
        // Handle different JSON formats:
        // 1. Object with annotations: { annotations: [...] } - our export format
        // 2. Direct array: [...]
        var list = [];
        if (Array.isArray(data.annotations)) {
          list = data.annotations;
        } else if (Array.isArray(data)) {
          list = data;
        }
        if (!list.length) {
          alert("No annotations found in JSON.");
          return;
        }
        var firstPage = null;
        for (var i = 0; i < list.length; i++) {
          var a = list[i];
          var pageNum = a.page || 1;
          var pg = pages[pageNum - 1];
          if (!pg) continue;
          if (firstPage === null) firstPage = pageNum;
          if (a.type === "pen" || a.type === "highlight") {
            var id = a.id || uid();
            var path = document.createElementNS("http://www.w3.org/2000/svg", "path");
            path.setAttribute("data-id", id);
            path.setAttribute("data-type", a.type);
            if (a.locked) path.setAttribute("data-locked", "true");
            path.setAttribute("fill", "none");
            path.setAttribute("stroke-linecap", "round");
            path.setAttribute("stroke-linejoin", "round");
            var pts = Array.isArray(a.points) ? a.points : [];
            if (pts.length) {
              var d = "M" + pts[0].x + "," + pts[0].y;
              for (var j = 1; j < pts.length; j++) {
                d += " L" + pts[j].x + "," + pts[j].y;
              }
              path._points = pts.slice();
              path.setAttribute("d", d);
            }
            var width = +a.width || (a.type === "highlight" ? 16 : 3);
            path.setAttribute("stroke-width", String(width));
            if (a.type === "highlight") {
              var col = a.color || highColor;
              // Check if color is already in rgba format
              if (col.indexOf("rgba") === 0 || col.indexOf("rgb") === 0) {
                path.setAttribute("stroke", col);
              } else {
                // Convert hex to rgba
                var rgbv = hexToRgb(col);
                path.setAttribute("stroke", "rgba(" + rgbv.r + "," + rgbv.g + "," + rgbv.b + ",0.35)");
              }
              path.style.mixBlendMode = "multiply";
            } else {
              path.setAttribute("stroke", a.color || penColor);
            }
            var del1 = makeDeleteBtnSVG(path, pg.svg);
            del1.setAttribute("data-visible", "false");
            pg.svg.append(path, del1);
            emit("annotation:created", { id: id, type: a.type, page: pg.num, points: pts, createdAt: Date.now() });
          } else if (a.type === "image") {
            if (!a.src) continue;
            var r = a.rect || a.rectangle || {};
            var w = +r.width || 200,
              h = +r.height || 140,
              x = +r.x || 0,
              y = +r.y || 0;
            var el = placeImageAtXY(pg, x, y, a.src, w, h);
            if (a.id) el.dataset.annoId = a.id; // Preserve original annotation ID
            if (a.stamp) el.dataset.stamp = "true";
            if (a.locked) el.dataset.locked = "true";
          } else if (a.type === "text") {
            var rt = a.rect || a.rectangle || {};
            var wt = +rt.width || 220,
              ht = +rt.height || 60,
              xt = +rt.x || 0,
              yt = +rt.y || 0;
            var ann = document.createElement("div");
            ann.className = "ann-text";
            ann.dataset.type = "text";
            ann.dataset.annoId = a.id || uid();
            Object.assign(ann.dataset, { x: xt, y: yt, w: wt, h: ht });
            setBoxStyleFromData(ann);
            if (a.locked) ann.dataset.locked = "true";
            var text = document.createElement("div");
            text.className = "text";
            text.contentEditable = "true";
            text.spellcheck = false;
            text.textContent = a.text == null ? "" : String(a.text);
            text.style.color = a.color || textColor;
            if (a.fontSize) text.style.fontSize = +a.fontSize + "px";
            var del2 = document.createElement("button");
            del2.className = "delete";
            del2.textContent = "";
            del2.onclick = function (e) {
              e.stopPropagation();
              if (ann.dataset.locked === "true") return;
              var id = ann.dataset.annoId;
              var page = pg.num;
              ann.remove();
              clearSelection();
              emit("annotation:deleted", { id: id, type: "text", page: page, rect: getRectData(ann), deletedAt: Date.now() });
            };
            var res = document.createElement("div");
            res.className = "resize";
            res.title = "Resize box";
            ann.append(text, del2, res);
            pg.annLayer.append(ann);
            enableDrag(ann, pg);
            enableResizeBox(ann, pg, res);
            emit("annotation:created", { id: ann.dataset.annoId, type: "text", page: pg.num, rect: getRectData(ann), createdAt: Date.now() });
          }
        }
        if (firstPage) scrollToPage(firstPage);
      }

      /* ===== Export (flatten) ===== */
      exportBtn.addEventListener("click", async () => {
        if (!pdfDoc || !originalPdfBytes) return;
        const bytes = await exportAnnotated();
        const blob = new Blob([bytes], { type: "application/pdf" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        const base = currentName.replace(/\.pdf$/i, "") || "document";
        a.download = `${base}  annotated.pdf`;
        document.body.appendChild(a);
        a.click();
        a.remove();
        URL.revokeObjectURL(url);
      });
      function isPng(b) {
        return b.length > 8 && b[0] === 0x89 && b[1] === 0x50 && b[2] === 0x4e && b[3] === 0x47 && b[4] === 0x0d && b[5] === 0x0a && b[6] === 0x1a && b[7] === 0x0a;
      }
      function isJpg(b) {
        return b.length > 3 && b[0] === 0xff && b[1] === 0xd8;
      }
      function parseDataUrl(u) {
        const m = u.match(/^data:([^;]+);base64,(.*)$/);
        if (!m) return null;
        const bin = atob(m[2]);
        const bytes = new Uint8Array(bin.length);
        for (let i = 0; i < bin.length; i++) bytes[i] = bin.charCodeAt(i);
        return { mime: m[1], bytes };
      }
      async function urlToBlob(src) {
        const resp = await fetch(src, { mode: "cors" });
        return { blob: await resp.blob() };
      }
      async function rasterizeToPngFromBlob(blob) {
        const url = URL.createObjectURL(blob);
        try {
          const img = await new Promise((res, rej) => {
            const im = new Image();
            im.crossOrigin = "anonymous";
            im.onload = () => res(im);
            im.onerror = rej;
            im.src = url;
          });
          const c = document.createElement("canvas");
          c.width = img.naturalWidth || img.width;
          c.height = img.naturalHeight || img.height;
          c.getContext("2d").drawImage(img, 0, 0);
          const parsed = parseDataUrl(c.toDataURL("image/png"));
          return parsed.bytes;
        } finally {
          URL.revokeObjectURL(url);
        }
      }
      async function imageToBytes(imgEl) {
        if (imgEl.src.startsWith("data:")) {
          const p = parseDataUrl(imgEl.src);
          if (!p) throw new Error("bad image");
          if (isPng(p.bytes)) return { kind: "png", bytes: p.bytes };
          if (isJpg(p.bytes)) return { kind: "jpg", bytes: p.bytes };
          const blob = new Blob([p.bytes]);
          const png = await rasterizeToPngFromBlob(blob);
          return { kind: "png", bytes: png };
        }
        const { blob } = await urlToBlob(imgEl.src);
        const buf = new Uint8Array(await blob.arrayBuffer());
        if (isPng(buf)) return { kind: "png", bytes: buf };
        if (isJpg(buf)) return { kind: "jpg", bytes: buf };
        const png = await rasterizeToPngFromBlob(blob);
        return { kind: "png", bytes: png };
      }
      async function exportAnnotated() {
        const src = originalPdfBytes instanceof Uint8Array ? originalPdfBytes : new Uint8Array(originalPdfBytes);
        const pdf = await PDFDocument.load(src);
        const helv = await pdf.embedStandardFont(StandardFonts.Helvetica);
        for (let i = 0; i < pages.length; i++) {
          const p = pages[i];
          const page = pdf.getPage(i);
          const pdfW = page.getWidth(),
            pdfH = page.getHeight();
          const factor = pdfW / p.baseW;
          const svgClone = p.svg.cloneNode(true);
          svgClone.querySelectorAll("g.svg-delete").forEach((n) => n.remove());
          const svgStr = new XMLSerializer().serializeToString(svgClone);
          if (svgStr.includes("<path")) {
            const svgBlob = new Blob([svgStr], { type: "image/svg+xml" });
            const url = URL.createObjectURL(svgBlob);
            const img = await new Promise((res) => {
              const im = new Image();
              im.onload = () => res(im);
              im.src = url;
            });
            const c = document.createElement("canvas");
            c.width = p.baseW;
            c.height = p.baseH;
            c.getContext("2d").drawImage(img, 0, 0, p.baseW, p.baseH);
            URL.revokeObjectURL(url);
            const parsed = parseDataUrl(c.toDataURL("image/png"));
            const png = await pdf.embedPng(parsed.bytes);
            page.drawImage(png, { x: 0, y: 0, width: pdfW, height: pdfH });
          }
          const imgs = Array.from(p.annLayer.querySelectorAll(".ann[data-type=image]"));
          for (const el of imgs) {
            const imgEl = el.querySelector("img");
            if (!imgEl) continue;
            const rect = getRectData(el);
            const drawW = rect.width * factor,
              drawH = rect.height * factor;
            const x = rect.x * factor,
              y = pdfH - rect.y * factor - drawH;
            const { kind, bytes } = await imageToBytes(imgEl);
            const emb = kind === "png" ? await pdf.embedPng(bytes) : await pdf.embedJpg(bytes);
            page.drawImage(emb, { x, y, width: drawW, height: drawH });
          }
          const txts = Array.from(p.annLayer.querySelectorAll(".ann-text[data-type=text]"));
          for (const ann of txts) {
            const t = ann.querySelector(".text");
            const content = (t.textContent || "").trim();
            if (!content) continue;
            const rect = getRectData(ann);
            const fs = parseFloat(getComputedStyle(t).fontSize) || 18;
            const size = fs * factor;
            const x = rect.x * factor;
            const y = pdfH - rect.y * factor - size * 0.2;
            const style = getComputedStyle(t);
            const col = style.color.match(/\d+(\.\d+)?/g) || [0, 0, 0];
            const color = rgb((+col[0] || 0) / 255, (+col[1] || 0) / 255, (+col[2] || 0) / 255);
            const lines = content.split(/\n/);
            const leading = size * 1.25;
            lines.forEach((line, idx) => page.drawText(line, { x, y: y - idx * leading, size, font: helv, color }));
          }
        }
        return await pdf.save();
      }

      /* ===== File load + Demo ===== */
      fileInput.addEventListener("change", async (e) => {
        const f = e.target.files?.[0];
        if (!f) return;
        try {
          if (pdfDoc && pdfDoc.destroy) await pdfDoc.destroy();
        } catch (e) {}
        try {
          if (pdfDoc && pdfDoc.cleanup) await pdfDoc.cleanup();
        } catch (e) {}
        const ab = await f.arrayBuffer();
        const bytes = new Uint8Array(ab);
        currentName = f.name || "document.pdf";
        originalPdfBytes = bytes.slice();
        pdfDoc = await pdfjsLib.getDocument({ data: bytes }).promise;
        await build();
      });
      (async function demo() {
        try {
          const url = "https://mozilla.github.io/pdf.js/web/compressed.tracemonkey-pldi-09.pdf";
          const ab = await (await fetch(url)).arrayBuffer();
          const bytes = new Uint8Array(ab);
          currentName = "compressed.tracemonkey-pldi-09.pdf";
          originalPdfBytes = bytes.slice();
          pdfDoc = await pdfjsLib.getDocument({ data: bytes }).promise;
          await build();
        } catch {}
      })();

      /* ===== Font size controls ===== */
      const fontDecBtn = document.getElementById("fontDec");
      const fontIncBtn = document.getElementById("fontInc");
      if (fontDecBtn) {
        fontDecBtn.onclick = (e) => {
          e.stopPropagation();
          adjustSelectedTextFont(-2);
        };
      }
      if (fontIncBtn) {
        fontIncBtn.onclick = (e) => {
          e.stopPropagation();
          adjustSelectedTextFont(+2);
        };
      }
      function adjustSelectedTextFont(delta) {
        if (!selectedAnn || !selectedAnn.classList.contains("ann-text")) return;
        const t = selectedAnn.querySelector(".text");
        if (!t) return;
        const fs = parseFloat(getComputedStyle(t).fontSize) || 18;
        const next = Math.max(8, Math.min(200, fs + delta));
        t.style.fontSize = next + "px";
        const p = pages.find((pg) => pg.annLayer.contains(selectedAnn));
        if (p) {
          emit("annotation:updated", { id: selectedAnn.dataset.annoId, type: "text", page: p.num, rect: getRectData(selectedAnn), reason: "font", updatedAt: Date.now() });
        }
      }

      // Ensure all buttons have type="button" to prevent form submission
      document.querySelectorAll("#divToolbar button").forEach(function (btn) {
        if (!btn.type) btn.type = "button";
      });

      // Initialize KTMenu for dropdowns
      if (typeof window.KTMenu !== "undefined" && window.KTMenu.init) {
        setTimeout(function () {
          try {
            window.KTMenu.init();
          } catch (e) {
            console.warn("KTMenu initialization:", e);
          }
        }, 200);
      } else if (typeof window.KTComponents !== "undefined" && window.KTComponents.init) {
        setTimeout(function () {
          try {
            window.KTComponents.init();
          } catch (e) {
            console.warn("KTComponents initialization:", e);
          }
        }, 200);
      }
    </script>
  </body>
</html>
